<!--
ä¿å­˜åï¼šindex.html
ç½®ãå ´æ‰€ï¼šbooking.html / philosophy.html ã¨ã€ŒåŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã€ã«ç½®ã

â˜…å·®ã—æ›¿ãˆå¿…é ˆï¼ˆCtrl+Fã§æ¤œç´¢ï¼‰
- LINE_URL
- EMAIL_TO
- INSTAGRAM_URL / TWITCASTING_URL
- GMAPS_API_KEYï¼ˆè·é›¢è‡ªå‹•ç®—å‡ºã—ãŸã„å ´åˆã®ã¿ï¼‰
-->
<!doctype html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>é‹è³ƒè¨ˆç®—æ©Ÿï½œè»½è²¨ç‰©TAKE</title>
  <meta name="description" content="è»½è²¨ç‰©TAKEï¼ˆä¸‹é–¢ï¼‰è¦‹ç©è¨ˆç®—æ©Ÿã€‚æ–™é‡‘ã‚’ãã®å ´ã§è¡¨ç¤ºâ†’LINE/ãƒ¡ãƒ¼ãƒ«ã¸æµã—è¾¼ã¿â†’æœ¬å¥‘ç´„ï¼ˆåˆ¥ãƒšãƒ¼ã‚¸ï¼‰ã€‚" />
  <style>
    :root{
      --bg: #fffbfa;
      --bg2: #fff0f3;
      --panel: #ffffff;
      --text: #2d2a26;
      --muted: #6b6560;
      --line: rgba(0,0,0,.08);
      --accent: #d48494;
      --accent2: #6b9b5a;
      --warn: #b45309;
      --danger: #c45c5c;
      --shadow: 0 4px 24px rgba(0,0,0,.06);
      --radius: 20px;
      --radius2: 16px;
      --flash: rgba(212,132,148,.4);
      --flashBg: rgba(212,132,148,.08);
      --navy1: #4a6fa5;
      --navy2: #3d5a80;
    }
    @media (prefers-reduced-motion: reduce){
      *,*::before,*::after{ animation-duration:0.01ms !important; transition-duration:0.01ms !important; }
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Yu Gothic", Arial, sans-serif;
      background: linear-gradient(180deg, var(--bg2) 0%, var(--bg) 25%, #ffffff 70%);
      color:var(--text);
      min-height:100vh;
      font-size: 17px;
      line-height: 1.75;
      position: relative;
    }
    body::before{
      content: "";
      position: fixed;
      top: -80px; right: -80px;
      width: 280px; height: 280px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255,200,210,.4) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }
    body::after{
      content: "";
      position: fixed;
      bottom: -60px; left: -60px;
      width: 220px; height: 220px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255,220,230,.35) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
    }
    a{color:inherit}
    .wrap{max-width:1100px;margin:0 auto;padding:24px 20px 48px;position:relative;z-index:1}
    header{
      display:flex;align-items:center;justify-content:space-between;gap:16px;
      padding:16px 0 20px;
      position:sticky;top:0;z-index:10;
      background: rgba(255,251,250,.92);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-bottom: 1px solid var(--line);
    }
    .brand{display:flex;align-items:center;gap:12px;font-weight:800;letter-spacing:.04em;}
    .logo{
      width:42px;height:42px;border-radius:14px;
      background: linear-gradient(135deg, var(--accent), #e8a0b0);
      box-shadow: var(--shadow);
      display:flex;align-items:center;justify-content:center;
    }
    nav{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end}
    nav a{
      text-decoration:none;
      padding:12px 18px;
      min-height:48px;
      min-width:48px;
      box-sizing:border-box;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      border-radius:999px;
      color:var(--muted);
      border:1px solid transparent;
      font-weight:700;
      font-size: 15px;
      transition: transform .2s ease, border-color .2s ease, background .2s ease, color .2s ease;
    }
    nav a:hover,nav a:focus{border-color:var(--line);background: rgba(212,132,148,.12); color:var(--text)}
    nav a.nav-active{background: rgba(212,132,148,.18); border-color: rgba(212,132,148,.4); color: #b85c6c;}

    /* ã‚¢ãƒ³ã‚«ãƒ¼ä½ç½®è£œæ­£ï¼ˆå›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼å¯¾ç­–ï¼‰ */
    #estimate,#services,#faq,#contact{ scroll-margin-top: 92px; }

    .hero{
      display:grid;
      grid-template-columns: 1.05fr .95fr;
      gap:18px;
      align-items:stretch;
    }
    @media (max-width: 920px){ .hero{grid-template-columns:1fr} }

    .card{
      background:var(--panel);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .heroLeft{padding:26px;position:relative;}
    .kicker{
      display:inline-flex;align-items:center;gap:8px;
      padding:8px 12px;border-radius:999px;
      background: rgba(212,132,148,.1);
      border:1px solid rgba(212,132,148,.25);
      color: #b85c6c;
      font-weight:700;
      font-size: 14px;
    }
    h1{
      margin:14px 0 10px;
      font-size: 1.85rem;
      line-height: 1.2;
      letter-spacing:-0.02em;
    }
    @media (max-width: 520px){ h1{font-size: 1.5rem} }
    .lead{
      margin:0 0 16px;
      color:var(--muted);
      font-size: 17px;
      line-height: 1.7;
    }
    .mini{font-size: 15px;color:var(--muted);line-height:1.65;margin:8px 0 0}

    .heroRight{padding:0}
    .calcHead{
      padding:18px 18px 10px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(212,132,148,.06), transparent);
    }
    .calcTitle{display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap;}
    .calcTitle h2{margin:0;font-size: 17px;}
    .hint{font-size: 15px;color:var(--muted);line-height:1.55;}
    .tabs{
      display:flex;gap:8px;margin-top:12px;
      background:#fff;border:1px solid var(--line);border-radius:999px;padding:6px;
      width:max-content;
    }
    .tabBtn{
      border:0;background:transparent;
      padding:10px 12px;border-radius:999px;
      cursor:pointer;color:var(--muted);
      font-weight:900;font-size:13px;
    }
    .tabBtn[aria-selected="true"]{
      background: linear-gradient(135deg, var(--accent), #e8a0b0);
      color:#fff;
      box-shadow: var(--shadow);
    }
    .calcBody{padding:18px}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
    @media (max-width: 520px){ .grid{grid-template-columns:1fr} }
    label{display:block;font-size: 15px;color:var(--muted);font-weight:700;margin:2px 0 6px}
    input, select, textarea{
      width:100%;
      padding:14px 16px;
      border-radius: var(--radius2);
      border:1px solid var(--line);
      outline:none;background:#fff;color:var(--text);
      font-size: 17px;
      transition: border-color .2s ease, box-shadow .2s ease;
    }
    textarea{min-height:78px;resize:vertical}
    input:focus, select:focus, textarea:focus{
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(212,132,148,.2);
    }
    select{ color-scheme: light; cursor: pointer; }
    select option{ background-color: #fff; color: var(--text); }
    select option:hover, select option:focus{ background-color: rgba(212,132,148,.12); color: var(--text); }
    select option:checked{ background-color: rgba(212,132,148,.2); color: var(--text); }
    input[type="range"]{padding:0;height:42px}
    .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:10px;
      padding:14px 20px;
      min-height:48px;
      border-radius: var(--radius2);
      border:1px solid var(--line);
      background:#fff;color:var(--text);
      font-weight:700;
      font-size: 16px;
      cursor:pointer;text-decoration:none;
      transition: transform .15s ease, box-shadow .15s ease;
      user-select:none;
    }
    .btn:hover{transform: translateY(-1px)}
    .btnPrimary{
      border-color: var(--accent);
      background: linear-gradient(135deg, var(--accent), #e8a0b0);
      color:#fff;
      box-shadow: var(--shadow);
    }
    .btnGhost{
      background: rgba(212,132,148,.08);
      border-color: rgba(212,132,148,.3);
      color: #b85c6c;
    }
    .btnWarn{
      background:rgba(180,83,9,.07);
      border-color: rgba(180,83,9,.18);
      color: rgba(180,83,9,.95);
    }
    .btnLine{
      border:0;
      background: linear-gradient(135deg, #06c755, #1abf5b);
      color:#fff;
      box-shadow: 0 10px 20px rgba(6,199,85,.18);
    }
    /* ãƒ¡ãƒ¼ãƒ«ãƒœã‚¿ãƒ³å¼·èª¿ï¼ˆãƒã‚¤ãƒ“ãƒ¼ï¼‰ */
    .btnMail{
      border:0;
      background: linear-gradient(135deg, var(--navy1), var(--navy2));
      color:#fff;
      box-shadow: 0 10px 20px rgba(30,58,138,.18);
    }

    .section{margin-top:14px;padding-top:14px;border-top:1px dashed var(--line);}
    .result{
      margin-top:14px;
      background: rgba(212,132,148,.06);
      border:1px solid rgba(212,132,148,.2);
      border-radius:var(--radius2);
      padding:14px;
      display:none;
    }
    .price{
      font-size:34px;font-weight:1000;margin:6px 0 2px;
      letter-spacing:-0.03em;color:var(--danger);
    }
    .planBadge{
      display:inline-flex;gap:8px;align-items:center;
      padding:6px 10px;border-radius:999px;
      background:#fff;border:1px solid var(--line);font-weight:1000;font-size:12px;
    }
    .break{
      margin-top:10px;border-top:1px dashed var(--line);
      padding-top:10px;display:grid;grid-template-columns:1fr;gap:6px;
      font-size: 16px;color:var(--muted);
    }
    .breakRow{display:flex;justify-content:space-between;gap:10px}
    .breakRow strong{color:var(--text)}

    .toast{
      position:fixed;right:16px;bottom:16px;z-index:9999;
      background:#fff;border:1px solid var(--line);
      box-shadow:var(--shadow);
      border-radius:14px;padding:12px 14px;min-width:240px;
      display:none;
    }
    .toast b{display:block;margin-bottom:2px}
    footer{
      margin:18px 0 0;
      color:var(--muted);
      font-size:12px;
      line-height:1.7;
    }
    .stack{display:flex;flex-direction:column;gap:12px}

    /* bounceï¼ˆæœ¬å¥‘ç´„ãƒœã‚¿ãƒ³ç”¨ï¼‰ */
    @keyframes bounceIn {
      0%   { transform: translateY(0) scale(1); }
      20%  { transform: translateY(-6px) scale(1.02); }
      40%  { transform: translateY(0) scale(1); }
      60%  { transform: translateY(-4px) scale(1.01); }
      80%  { transform: translateY(0) scale(1); }
      100% { transform: translateY(0) scale(1); }
    }
    .bounce { animation: bounceIn 1.0s ease-out 0s 2; }
    .pulseGlow{
      box-shadow: 0 0 0 0 rgba(212,132,148,.25), var(--shadow);
      animation: glow 1.2s ease-out 0s 2;
    }
    @keyframes glow{
      0%{ box-shadow: 0 0 0 0 rgba(212,132,148,.2), var(--shadow); }
      50%{ box-shadow: 0 0 0 8px rgba(212,132,148,.1), var(--shadow); }
      100%{ box-shadow: 0 0 0 0 rgba(212,132,148,.0), var(--shadow); }
    }

    /* æµ®éŠã®æˆ»ã‚‹ãƒœã‚¿ãƒ³ */
    .fabTop{
      position:fixed;left:16px;bottom:16px;z-index:9998;
      display:none;
    }

    details{
      border:1px solid var(--line);
      background:#fff;
      border-radius:14px;
      padding:12px;
    }
    summary{
      cursor:pointer;
      font-weight:900;
      color:var(--text);
      list-style:none;
    }
    summary::-webkit-details-marker{display:none}
    .smallNote{font-size:12px;color:var(--muted);line-height:1.6;margin:6px 0 0}

    /* SNS â€œãã‚Œã£ã½ã„â€ãƒœã‚¿ãƒ³ */
    .btnInsta{
      border:0;color:#fff;
      background: linear-gradient(135deg, #f58529, #dd2a7b, #8134af, #515bd4);
      box-shadow: 0 10px 20px rgba(221,42,123,.18);
    }
    .btnTwitc{
      border:0;color:#fff;
      background: linear-gradient(135deg, #00a7e0, #0088cc);
      box-shadow: 0 10px 20px rgba(0,167,224,.18);
    }
    .icon24{width:18px;height:18px;display:inline-block}

    /* å³è¨ˆç®—æ©Ÿï¼šè‡ªå‹•å…¥åŠ›ç®‡æ‰€ãƒã‚¤ãƒ©ã‚¤ãƒˆï¼ˆãƒ•ãƒ©ãƒƒã‚·ãƒ¥ï¼‰ */
    @keyframes flashGlow{
      0%   { box-shadow: 0 0 0 0 rgba(212,132,148,0); border-color: var(--line); background:#fff; }
      20%  { box-shadow: 0 0 0 6px rgba(212,132,148,.2); border-color: var(--flash); background: var(--flashBg); }
      55%  { box-shadow: 0 0 0 2px rgba(212,132,148,.1); border-color: rgba(212,132,148,.4); background: rgba(212,132,148,.06); }
      100% { box-shadow: 0 0 0 0 rgba(212,132,148,0); border-color: var(--line); background:#fff; }
    }
    .flash{
      animation: flashGlow 1.25s ease-out 0s 1;
    }

    /* æ—¥ä»˜ãƒ”ãƒƒã‚«ãƒ¼ï¼ˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ï¼‰ */
    .dtOverlay{
      position:fixed; inset:0; z-index:10000;
      display:none; align-items:center; justify-content:center;
      padding:18px;
      background: rgba(0,0,0,.35);
      backdrop-filter: blur(6px);
    }
    .dtPanel{
      width:100%; max-width:420px;
      background: var(--panel);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .dtHead{
      padding:14px 14px 10px;
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(212,132,148,.06), transparent);
      font-weight:1000;
    }
    /* ãƒ˜ãƒ«ãƒ—ã€Œï¼Ÿã€ãƒœã‚¿ãƒ³ãƒ»ãƒ¢ãƒ¼ãƒ€ãƒ« */
    .helpBtn{
      display:inline-flex;align-items:center;justify-content:center;
      width:40px;height:40px;min-width:40px;min-height:40px;
      border-radius:50%;
      border:1px solid var(--line);
      background:#fff;
      color:var(--muted);
      font-size: 1.1rem;
      font-weight:700;
      cursor:pointer;
      transition: border-color .2s, background .2s, color .2s;
    }
    .helpBtn:hover,.helpBtn:focus{ border-color: var(--accent); background: rgba(212,132,148,.12); color: var(--accent); }
    .sectionHead{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    .helpOverlay{
      position:fixed;inset:0;z-index:10001;
      display:none;align-items:center;justify-content:center;
      padding:20px;
      background: rgba(0,0,0,.4);
      backdrop-filter: blur(4px);
    }
    .helpOverlay[aria-hidden="false"]{ display:flex; }
    .helpModal{
      max-width:420px;width:100%;
      max-height:85vh;overflow:auto;
      background: var(--panel);
      border:1px solid var(--line);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:24px;
    }
    .helpModal h3{ margin:0 0 12px; font-size: 1.15rem; }
    .helpModal p{ margin:0; font-size: 16px; line-height: 1.75; color: var(--text); }
    .helpModal .closeBtn{ margin-top:16px; min-height:48px; }
    .dtBody{padding:14px}
    .dtFoot{
      padding:14px;
      border-top:1px dashed var(--line);
      display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap;
    }
  </style>

<style>
/* --- Customer site integration (è¡¨ç¤ºã ã‘æ•´ç†ï¼šè¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ã¯æœªå¤‰æ›´) --- */
#tabHelping, #panelHelping { display:none !important; }
#h_booking, #d_booking { display:none !important; }
</style>

</head>

<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <!-- è¦ªã—ã¿ã‚„ã™ã„è»½ãƒãƒ³ï¼†æ®µãƒœãƒ¼ãƒ«ï¼ˆSVGï¼‰ -->
          <svg width="24" height="24" viewBox="0 0 24 24" aria-hidden="true">
            <g fill="none" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" opacity="0.95">
              <path d="M3 14.5v-3.2c0-1.1.9-2 2-2h7.2l2.2 2.6H20c.6 0 1 .4 1 1v3.6"/>
              <path d="M6.2 14.5h9.6"/>
              <path d="M11.2 9.3l.9-1.3h3l1.2 1.4"/>
              <circle cx="7" cy="16.5" r="1.6"/>
              <circle cx="18" cy="16.5" r="1.6"/>
            </g>
          </svg>
        </div>
        <div>
          <div style="font-size:16px;opacity:.95">è»½è²¨ç‰©TAKE</div>
          <div style="font-size:14px;color:var(--muted);font-weight:700">ä¸‹é–¢ï½œä»£è¡¨ï¼šæ¾æ°¸ ãŸã‘ã—</div>
        </div>
      </div>
      <nav>
        <a href="index.html" class="nav-active" aria-current="page">TOP</a>
        <a href="booking.html">äºˆç´„</a>
        <a href="philosophy.html">ç†å¿µ</a>
      </nav>
    </header>

    <section class="hero" id="estimate">
      <div class="card heroLeft">
        <span class="kicker">æ–™é‡‘ãŒãã®å ´ã§å‡ºã‚‹ï½œ20kmåœå†… å‡ºå¼µç„¡æ–™</span>
        <div class="sectionHead">
          <h1>ã™ãé ¼ã‚ã‚‹å„ªã—ã„è»½è²¨ç‰©</h1>
          <button type="button" class="helpBtn" aria-label="ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®èª¬æ˜" data-help="hero">ï¼Ÿ</button>
        </div>
        <p class="lead">
          å·¦ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’æŠ¼ã™ã¨ã€å³ã®è¨ˆç®—æ©ŸãŒè‡ªå‹•ã§åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚<br>
          ã¾ãšã¯ã€Œã„ãã‚‰ã‹ï¼Ÿã€ã‚’å‡ºã—ã¦ã€ãƒšãƒ¼ã‚¸ä¸‹ã®<strong>LINE</strong>ã‹<strong>ãƒ¡ãƒ¼ãƒ«</strong>ã§é€ã£ã¦ãã ã•ã„ã€‚
        </p>

        <p class="mini" id="flow">
          <strong>æµã‚Œï¼š</strong> â‘ è¦‹ç©ï¼ˆå³ï¼‰ â†’ â‘¡ä¸‹ã®LINE/ãƒ¡ãƒ¼ãƒ«ã§ç›¸è«‡ãƒ»åˆæ„ â†’ â‘¢æœ¬å¥‘ç´„ï¼ˆåˆ¥ãƒšãƒ¼ã‚¸ï¼‰ â†’ â‘£å½“æ—¥ä½œæ¥­ãƒ»å½“æ—¥æ±ºæ¸ˆ
        </p>

        <div class="section" id="services">
          <div class="sectionHead">
            <span class="hint" style="font-weight:700;margin-bottom:8px">ã§ãã‚‹ã“ã¨ï¼ˆæŠ¼ã™ã¨å³ã«åæ˜ ï¼‰</span>
            <button type="button" class="helpBtn" aria-label="ã§ãã‚‹ã“ã¨ã®èª¬æ˜" data-help="services">ï¼Ÿ</button>
          </div>

          <div class="stack">
            <details open>
              <summary data-preset="grass">è‰åˆˆã‚Šï¼ˆè¢‹è©°ã‚è¾¼ï½œé¢ç©ã§è¦‹ç©ï¼‰</summary>
              <div class="smallNote">
                æ™‚é–“ã§ã¯ãªã<strong>åºƒã•ï¼ˆã¡ï¼‰</strong>ã§æ¦‚ç®—ã—ã¾ã™ï¼ˆç›¸å ´ã®ç´„8å‰²ç›®å®‰ï¼‰ã€‚<br>
                â€»å›åãƒ»æŒã¡å¸°ã‚Šãƒ»å‡¦åˆ†ã¯è¡Œã„ã¾ã›ã‚“ï¼ˆè¢‹è©°ã‚ã¾ã§ï¼‰ã€‚ã‚´ãƒŸå‡ºã—ã¯ãŠå®¢æ§˜ã¸ã€‚
              </div>
            </details>

            <details>
              <summary data-preset="kerosene">ç¯æ²¹è²·ã„å‡ºã—ï¼†çµ¦æ²¹ï¼ˆãƒãƒªç¼¶æ•°ã§è¦‹ç©ï¼‰</summary>
              <div class="smallNote">
                18Lãƒãƒªç¼¶ã®<strong>å€‹æ•°</strong>ã§æ¦‚ç®—ã—ã¾ã™ï¼ˆå°‘é‡ä¾é ¼å‘ã‘ã®åŸºæœ¬æ–™é‡‘ï¼‹åŠ ç®—ï¼‰ã€‚<br>
                â€»ç¯æ²¹ä»£ï¼ˆå•†å“ä»£ï¼‰ã¯å®Ÿè²»ã§ã™ï¼ˆã“ã“ã§ã¯å«ã‚ã¾ã›ã‚“ï¼‰ã€‚
              </div>
            </details>

            <details>
              <summary data-preset="estate">ä¸ç”¨å“ä»•åˆ†ã‘ãƒ»ç‰‡ä»˜ã‘ç›¸è«‡ï¼ˆâ€»è²·å–ãªã—ï¼‰</summary>
              <div class="smallNote">
                è»Šä¸¡ãƒ—ãƒ©ãƒ³ï¼ˆ1å°/2å°ï¼‰ã¨ã‚¹ã‚¿ãƒƒãƒ•äººæ•°ã§æ¦‚ç®—ã—ã¾ã™ã€‚é‡é‡ç‰©ãŒã‚ã‚‹å ´åˆã¯å¢—å“¡ã—ã¾ã™ã€‚<br>
                â€»å›åãƒ»å‡¦åˆ†ã¯è¡Œã„ã¾ã›ã‚“ï¼ˆåˆ†åˆ¥ãƒ»è¢‹è©°ã‚ãƒ»æ’å‡ºã®æ®µå–ã‚Šä½œã‚ŠãŒä¸­å¿ƒï¼‰ã€‚
              </div>
            </details>

            <details>
              <summary data-preset="haul">é‹æ¬ï¼ˆé‹ã¶ãƒ»ç§»å‹•ï½œè·é›¢ï¼†éšæ®µã§è¦‹ç©ï¼‰</summary>
              <div class="smallNote">
                ç©åœ°ãƒ»å¸åœ°ã‚’å…¥ã‚Œã¦è·é›¢å–å¾—ï¼ˆGoogleé€£å‹•ï¼‰â†’å‡ºå¼µè²»ã‚’è‡ªå‹•åæ˜ ã€‚<br>
                éšæ®µãƒ»ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼æœ‰ç„¡ã§ä»˜å¸¯æ–™é‡‘ã‚‚è‡ªå‹•ã§åŠ ç®—ã—ã¾ã™ã€‚
              </div>
            </details>

            <details>
              <summary data-preset="shopping">è²·ã„ç‰©ä»£è¡Œï¼ˆ2,200å††ã€œï¼‰</summary>
              <div class="smallNote">
                åŸºæœ¬ 2,200å††ï¼ˆç¨è¾¼ï¼‰ã€œ ï¼‹ å‡ºå¼µè²»ï¼ˆ20kmã¾ã§ç„¡æ–™ï¼‰ã§æ¦‚ç®—ã—ã¾ã™ã€‚
              </div>
            </details>

            <details>
              <summary data-preset="carSupport">è»Šæ¤œãƒ»æ•´å‚™ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼è»Šæ¤œä»£è¡Œï¼æ•´å‚™å·¥å ´ã¸ã®æ¬å…¥ï¼‰</summary>
              <div class="smallNote">
                ã¾ãšã¯è·é›¢ã§æ¦‚ç®—ã€‚æ³•å®šè²»ç”¨ãƒ»æ•´å‚™è²»ã¯åˆ¥é€”ã§<strong>æœ€çµ‚è¦‹ç©</strong>ã«ãªã‚Šã¾ã™ã€‚
              </div>
            </details>

            <details>
              <summary data-preset="web">ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸åˆ¶ä½œï¼ˆè²·ã„åˆ‡ã‚Šï¼‰</summary>
              <div class="smallNote">
                <strong>33,000å††ï¼ˆç¨è¾¼ï¼‰ã€œ</strong>ï¼ˆæœ€ä½ä¾¡æ ¼ï¼‰ã¨ã—ã¦è¡¨ç¤ºã€‚å†…å®¹ã«ã‚ˆã‚Šå¢—æ¸›ã—ã¾ã™ã€‚
              </div>
            </details>
          </div>

          <div class="section">
            <div class="row">
              <a class="btn btnGhost" href="#estimate">å³ã®è¨ˆç®—æ©Ÿã¸</a>
              <a class="btn" href="./philosophy.html" target="_blank" rel="noopener">æƒ³ã„ï¼ˆåˆ¥ãƒšãƒ¼ã‚¸ï¼‰</a>
            </div>
            <p class="smallNote">
              â€»é€£çµ¡ã¯ãƒšãƒ¼ã‚¸ä¸‹ã®ã€ŒLINEã€ã€Œãƒ¡ãƒ¼ãƒ«ã€ã«ã¾ã¨ã‚ã¦ã„ã¾ã™ï¼ˆæ··åŒé˜²æ­¢ï¼‰ã€‚
            </p>
          </div>
        </div>
      </div>

      <div class="card heroRight">
        <div class="calcHead">
          <div class="calcTitle">
            <h2>è¦‹ç©ï¼ˆè¨ˆç®—æ©Ÿï¼‰ï½œç¨è¾¼</h2>
            <button type="button" class="helpBtn" aria-label="è¦‹ç©ã®èª¬æ˜" data-help="calc">ï¼Ÿ</button>
            <div class="hint" style="width:100%;margin-top:4px">20kmåœå†…ï¼šå‡ºå¼µç„¡æ–™ï¼è¶…éï¼š+550å††/5km</div>
          </div>

          <div class="tabs" role="tablist" aria-label="è¦‹ç©ã‚«ãƒ†ã‚´ãƒª">
            <button class="tabBtn" id="tabHelping" role="tab" aria-selected="false" aria-controls="panelHelping">æ‰‹ä¼ã†ãƒ»ä½œæ¥­</button>
            <button class="tabBtn" id="tabDriving" role="tab" aria-selected="true" aria-controls="panelDriving">é‹ã¶ãƒ»ç§»å‹•</button>
          </div>
        </div>

        <div class="calcBody">
          <!-- æ‰‹ä¼ã†ãƒ»ä½œæ¥­ -->
          <div id="panelHelping" role="tabpanel" aria-labelledby="tabHelping" class="stack" style="display:none">
            <div class="grid">
              <div style="grid-column:1/-1">
                <label>ã‚µãƒ¼ãƒ“ã‚¹</label>
                <select id="h_service">
                  <option value="grass">è‰åˆˆã‚Šï¼ˆè¢‹è©°ã‚è¾¼ï½œé¢ç©ï¼‰</option>
                  <option value="kerosene">ç¯æ²¹è²·ã„å‡ºã—ï¼†çµ¦æ²¹ï¼ˆãƒãƒªç¼¶æ•°ï¼‰</option>
                  <option value="estate">ä¸ç”¨å“ä»•åˆ†ã‘ãƒ»ç‰‡ä»˜ã‘ç›¸è«‡ï¼ˆè²·å–ãªã—ï¼‰</option>
                  <option value="light">è»½ä½œæ¥­ï¼ˆæƒé™¤/é›»çƒäº¤æ›/ã‚´ãƒŸå‡ºã—æº–å‚™ï¼‰</option>
                  <option value="hard">åŠ›ä»•äº‹ï¼ˆå®¶å…·ç§»å‹•/é‡é‡ç‰©ï¼‰</option>
                  <option value="web">ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸åˆ¶ä½œï¼ˆè²·ã„åˆ‡ã‚Šï¼‰</option>
                </select>
              </div>

              <div id="h_kmWrap">
                <label>è·é›¢ï¼ˆkmï¼‰</label>
                <input id="h_km" inputmode="decimal" placeholder="ä¾‹ï¼š12 / 25" />
                <div class="smallNote">â€»20kmã¾ã§å‡ºå¼µç„¡æ–™</div>
              </div>

              <div id="h_dtWrap">
                <label>å¸Œæœ›æ—¥æ™‚</label>
                <div class="row" style="flex-wrap:nowrap">
                  <input id="h_datetime" type="datetime-local" style="flex:1" />
                  <button class="btn btnGhost" type="button" id="h_dtPick" aria-label="ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã§é¸ã¶">ğŸ“…</button>
                  <button class="btn btnWarn" type="button" id="h_dtConfirm">æ±ºå®š</button>
                </div>
                <div class="smallNote" id="h_dtStatus">â€»æ—¥æ™‚ã¯æœªæ±ºå®šã§ã‚‚OKï¼ˆæ±ºå®šã™ã‚‹ã¨å›ºå®šã•ã‚Œã¾ã™ï¼‰</div>
              </div>

              <!-- è‰åˆˆã‚Šï¼šé¢ç© -->
              <div style="grid-column:1/-1" id="h_mode_grass" class="section" data-mode="grass">
                <label>åºƒã•ï¼ˆã¡ï¼‰</label>
                <div class="grid">
                  <div>
                    <input id="g_area" inputmode="decimal" value="30" />
                    <div class="smallNote">ä¾‹ï¼š30ã¡ï¼ˆç´„9åªï¼‰</div>
                  </div>
                  <div>
                    <input id="g_areaRange" type="range" min="0" max="300" step="5" value="30" />
                    <div class="smallNote">ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã§èª¿æ•´</div>
                  </div>
                </div>
                <div class="smallNote">
                  â€»ç›¸å ´ã®ç´„8å‰²ç›®å®‰ï¼š<strong id="g_rateLabel">145å††/ã¡</strong>ï¼ˆæœ€ä½åŸºæœ¬æ–™é‡‘ã‚ã‚Šï¼‰
                </div>
              </div>

              <!-- ç¯æ²¹ï¼šãƒãƒªç¼¶æ•° -->
              <div style="grid-column:1/-1" id="h_mode_kerosene" class="section" data-mode="kerosene" style="display:none">
                <label>18ãƒªãƒƒãƒˆãƒ«ãƒãƒªç¼¶ã®å€‹æ•°</label>
                <div class="row" style="flex-wrap:nowrap">
                  <button class="btn btnGhost" type="button" id="k_cansMinus" aria-label="å€‹æ•°ã‚’æ¸›ã‚‰ã™">ï¼</button>
                  <input id="k_cans" inputmode="numeric" value="1" style="flex:1;text-align:center;font-weight:900" />
                  <button class="btn btnGhost" type="button" id="k_cansPlus" aria-label="å€‹æ•°ã‚’å¢—ã‚„ã™">ï¼‹</button>
                </div>
                <div class="smallNote">â€»ç¯æ²¹ä»£ï¼ˆå•†å“ä»£ï¼‰ã¯å®Ÿè²»ã€‚ã“ã“ã¯ä½œæ¥­è²»ï¼‹å‡ºå¼µè²»ã®æ¦‚ç®—ã§ã™ã€‚</div>
              </div>

              <!-- ç‰‡ä»˜ã‘ï¼šè»Šä¸¡/äººå“¡ -->
              <div style="grid-column:1/-1" id="h_mode_estate" class="section" data-mode="estate" style="display:none">
                <div class="grid">
                  <div>
                    <label>è»Šä¸¡ãƒ—ãƒ©ãƒ³</label>
                    <select id="e_vans">
                      <option value="1">1å°ãƒ—ãƒ©ãƒ³</option>
                      <option value="2">2å°ãƒ—ãƒ©ãƒ³</option>
                    </select>
                    <div class="smallNote">â€»è»Šä¸¡è²»ï¼šå°æ•°Ã—3,300å††</div>
                  </div>
                  <div>
                    <label>é‡é‡ç‰©ï¼ˆå†·è”µåº«/æ´—æ¿¯æ©Ÿãªã©ï¼‰</label>
                    <select id="e_heavy">
                      <option value="0">ãªã—</option>
                      <option value="1">ã‚ã‚Šï¼ˆå¢—å“¡ã—ã¾ã™ï¼‰</option>
                    </select>
                    <div class="smallNote">â€»å¢—å“¡åˆ†ã¯åŠ ç®—</div>
                  </div>

                  <div>
                    <label>ã‚¹ã‚¿ãƒƒãƒ•äººæ•°</label>
                    <div class="row" style="flex-wrap:nowrap">
                      <button class="btn btnGhost" type="button" id="e_staffMinus" aria-label="äººæ•°ã‚’æ¸›ã‚‰ã™">ï¼</button>
                      <input id="e_staff" inputmode="numeric" value="1" style="flex:1;text-align:center;font-weight:900" />
                      <button class="btn btnGhost" type="button" id="e_staffPlus" aria-label="äººæ•°ã‚’å¢—ã‚„ã™">ï¼‹</button>
                    </div>
                    <div class="smallNote" id="e_staffHint">â€»1å°=åŸºæœ¬1å / 2å°=åŸºæœ¬2åï¼ˆé‡é‡ç‰©ãŒã‚ã‚‹ã¨å¢—å“¡ï¼‰</div>
                  </div>

                  <div>
                    <label>ä½œæ¥­æ™‚é–“ï¼ˆæ™‚é–“ï¼‰</label>
                    <div class="row" style="flex-wrap:nowrap">
                      <button class="btn btnGhost" type="button" id="e_hMinus" aria-label="æ™‚é–“ã‚’æ¸›ã‚‰ã™">ï¼</button>
                      <input id="e_hours" inputmode="decimal" value="2" style="flex:1;text-align:center;font-weight:900" />
                      <button class="btn btnGhost" type="button" id="e_hPlus" aria-label="æ™‚é–“ã‚’å¢—ã‚„ã™">ï¼‹</button>
                    </div>
                    <div class="smallNote">â€»0.5æ™‚é–“åˆ»ã¿ï¼ˆã‚¿ãƒƒãƒ—ã§ç›´æ¥å…¥åŠ›OKï¼‰</div>
                  </div>
                </div>

                <div class="smallNote">
                  â€»åç§°ã¯ã€Œç›¸è«‡ï¼ˆè²·å–ãªã—ï¼‰ã€ã§ã™ã€‚å›åãƒ»å‡¦åˆ†ã¯è¡Œã„ã¾ã›ã‚“ï¼ˆåˆ†åˆ¥ãƒ»è¢‹è©°ã‚ãƒ»æ’å‡ºæ®µå–ã‚Šä¸­å¿ƒï¼‰ã€‚
                </div>
              </div>

              <!-- å…±é€šï¼šä½œæ¥­æ™‚é–“ï¼ˆè»½/åŠ›ï¼‰ -->
              <div style="grid-column:1/-1" id="h_mode_hourly" class="section" data-mode="hourly" style="display:none">
                <div class="tabs" role="tablist" aria-label="ä½œæ¥­ã®ç¨®é¡">
                  <button class="tabBtn" id="h_typeLight" role="tab" aria-selected="true" type="button">è»½ä½œæ¥­ 2,200å††/æ™‚</button>
                  <button class="tabBtn" id="h_typeHard" role="tab" aria-selected="false" type="button">åŠ›ä»•äº‹ 3,300å††/æ™‚</button>
                </div>
                <div class="grid" style="margin-top:12px">
                  <div>
                    <label>äººæ•°</label>
                    <div class="row" style="flex-wrap:nowrap">
                      <button class="btn btnGhost" type="button" id="h_peopleMinus" aria-label="äººæ•°ã‚’æ¸›ã‚‰ã™">ï¼</button>
                      <input id="h_people" inputmode="numeric" value="1" style="flex:1;text-align:center;font-weight:900" />
                      <button class="btn btnGhost" type="button" id="h_peoplePlus" aria-label="äººæ•°ã‚’å¢—ã‚„ã™">ï¼‹</button>
                    </div>
                  </div>
                  <div>
                    <label>ä½œæ¥­æ™‚é–“ï¼ˆæ™‚é–“ï¼‰</label>
                    <div class="row" style="flex-wrap:nowrap">
                      <button class="btn btnGhost" type="button" id="h_hMinus" aria-label="æ™‚é–“ã‚’æ¸›ã‚‰ã™">ï¼</button>
                      <input id="h_hours" inputmode="decimal" value="1" style="flex:1;text-align:center;font-weight:900" />
                      <button class="btn btnGhost" type="button" id="h_hPlus" aria-label="æ™‚é–“ã‚’å¢—ã‚„ã™">ï¼‹</button>
                    </div>
                    <div class="smallNote">â€»0.5æ™‚é–“åˆ»ã¿ï¼ˆã‚¿ãƒƒãƒ—ã§ç›´æ¥å…¥åŠ›OKï¼‰</div>
                  </div>
                </div>
              </div>

              <!-- Webï¼šæœ€ä½ä¾¡æ ¼ -->
              <div style="grid-column:1/-1" id="h_mode_web" class="section" data-mode="web" style="display:none">
                <div class="smallNote">
                  â€»è²·ã„åˆ‡ã‚Šåˆ¶ä½œï¼š<strong>33,000å††ã€œ</strong>ï¼ˆæœ€ä½ä¾¡æ ¼ï¼‰ã€‚å†…å®¹ã§èª¿æ•´ã—ã¾ã™ã€‚
                </div>
              </div>

              <div style="grid-column:1/-1">
                <label>è£œè¶³ï¼ˆä»»æ„ï¼‰</label>
                <textarea id="h_note" placeholder="ä¾‹ï¼šå ´æ‰€ã€è‰ã®é‡ã€æ³¨æ„ç‚¹ãªã©"></textarea>
              </div>
            </div>

            <div class="row">
              <button class="btn btnPrimary" id="btnCalcHelping">è¨ˆç®—ã™ã‚‹ï¼ˆæ‰‹ä¼ã†ãƒ»ä½œæ¥­ï¼‰</button>
              <span class="hint">çµæœã«ã€Œã„ãã‚‰ã‹ï¼Ÿã€ã‚’è¡¨ç¤º â†’ LINE/ãƒ¡ãƒ¼ãƒ«ã¸è‡ªå‹•åæ˜ </span>
            </div>

            <div class="result" id="resultHelping" aria-live="polite">
              <div class="row" style="justify-content:space-between">
                <span class="planBadge" id="h_badge">æ‰‹ä¼ã†ãƒ»ä½œæ¥­ è¦‹ç©</span>
                <span class="hint">ç¨è¾¼æ¦‚ç®—</span>
              </div>
              <div class="price" id="h_total">0å††</div>
              <div class="break" id="h_breakdown"></div>

              <div class="section row">
                <button class="btn btnGhost" id="h_copy">å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼</button>
                <button class="btn" id="h_toContact">ä¸‹ã®LINE/ãƒ¡ãƒ¼ãƒ«ã¸</button>
                <button class="btn btnPrimary" id="h_booking" style="display:none">æœ¬å¥‘ç´„ï¼ˆåˆ¥ãƒšãƒ¼ã‚¸ï¼‰ã¸</button>
              </div>

              <p class="smallNote" id="h_legalNote">
                â€»è‰åˆˆã‚Šã¯ã€Œè¢‹è©°ã‚è¾¼ã€ã€‚å›åãƒ»æŒã¡å¸°ã‚Šãƒ»å‡¦åˆ†ã¯è¡Œã„ã¾ã›ã‚“ï¼ˆã‚´ãƒŸå‡ºã—ã¯ãŠå®¢æ§˜ã¸ï¼‰ã€‚<br>
                â€»ç¯æ²¹ã¯ç¯æ²¹ä»£ï¼ˆå•†å“ä»£ï¼‰ãŒå®Ÿè²»ã§ã™ï¼ˆã“ã“ã§ã¯å«ã‚ã¾ã›ã‚“ï¼‰ã€‚<br>
                â€»ç‰‡ä»˜ã‘ã¯ã€Œç›¸è«‡ï¼ˆè²·å–ãªã—ï¼‰ã€ã§ã™ã€‚å›åãƒ»å‡¦åˆ†ã¯è¡Œã„ã¾ã›ã‚“ï¼ˆåˆ†åˆ¥ãƒ»è¢‹è©°ã‚ãƒ»æ’å‡ºæ®µå–ã‚Šä¸­å¿ƒï¼‰ã€‚
              </p>
            </div>

            <footer>
              â€»æ¦‚ç®—ã§ã™ã€‚ç¾åœ°çŠ¶æ³ï¼ˆä½œæ¥­é‡/é§è»Š/è¿½åŠ ä½œæ¥­ãªã©ï¼‰ã§èª¿æ•´ãŒå…¥ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>
              â€»å½“æ—¥æ±ºæ¸ˆï¼ˆç¾é‡‘/æŒ¯è¾¼ï¼‰ã€‚ç¢ºå®šã¯ä¸‹ã®LINE/ãƒ¡ãƒ¼ãƒ«ã§åˆæ„å¾Œã«æœ¬å¥‘ç´„ã¸ã€‚
            </footer>
          </div>

          <!-- é‹ã¶ãƒ»ç§»å‹• -->
          <div id="panelDriving" role="tabpanel" aria-labelledby="tabDriving" class="stack">
            <div class="grid">
              <div style="grid-column:1/-1">
                <label>ã‚µãƒ¼ãƒ“ã‚¹</label>
                <select id="d_service">
                  <option value="haul">é‹æ¬ï¼ˆè·é›¢ï¼†éšæ®µã§è¦‹ç©ï¼‰</option>
                  <option value="shopping">è²·ã„ç‰©ä»£è¡Œï¼ˆ2,200å††ã€œï¼‰</option>
                  <option value="carSupport">è»Šæ¤œãƒ»æ•´å‚™ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼è»Šæ¤œä»£è¡Œï¼æ¬å…¥ï¼‰</option>
                </select>
                <div class="smallNote" id="d_serviceHint">â€»è·é›¢ãƒ»éšæ®µãƒ»è»Šä¸¡å°æ•°ãƒ»è¿½åŠ äººå“¡ã§å¤‰ã‚ã‚Šã¾ã™</div>
              </div>

              <div id="d_vansWrap">
                <label>è»Šä¸¡å°æ•°</label>
                <select id="d_vans">
                  <option value="1">1å°</option>
                  <option value="2">2å°</option>
                </select>
                <div class="smallNote">â€»2å°ã¯ã€Œèµ°è¡Œåˆ†ï¼ˆåŸºæœ¬ï¼‹å‡ºå¼µï¼‰ã€ãŒ2å€</div>
              </div>

              <div id="d_kmWrap">
                <label>è·é›¢ï¼ˆkmï¼‰</label>
                <input id="d_km" inputmode="decimal" placeholder="ä¾‹ï¼š8 / 30" />
                <div class="smallNote">â€»20kmã¾ã§å‡ºå¼µç„¡æ–™</div>
              </div>

              <div id="d_dtWrap">
                <label>å¸Œæœ›æ—¥æ™‚</label>
                <div class="row" style="flex-wrap:nowrap">
                  <input id="d_datetime" type="datetime-local" style="flex:1" />
                  <button class="btn btnGhost" type="button" id="d_dtPick" aria-label="ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã§é¸ã¶">ğŸ“…</button>
                  <button class="btn btnWarn" type="button" id="d_dtConfirm">æ±ºå®š</button>
                </div>
                <div class="smallNote" id="d_dtStatus">â€»æ—¥æ™‚ã¯æœªæ±ºå®šã§ã‚‚OKï¼ˆæ±ºå®šã™ã‚‹ã¨å›ºå®šã•ã‚Œã¾ã™ï¼‰</div>
              </div>

              <!-- ãƒ«ãƒ¼ãƒˆå…¥åŠ›ï¼ˆé‹æ¬ç”¨ï¼‰ -->
              <div style="grid-column:1/-1" id="d_mode_haul" class="section" data-mode="haul">
                <div class="grid">
                  <div>
                    <label>ç©åœ°ï¼ˆå‡ºç™ºï¼‰</label>
                    <input id="d_origin" placeholder="ä¾‹ï¼šä¸‹é–¢é§… / ä¸‹é–¢å¸‚ã€‡ã€‡" />
                  </div>
                  <div>
                    <label>å¸åœ°ï¼ˆåˆ°ç€ï¼‰</label>
                    <input id="d_destination" placeholder="ä¾‹ï¼šå”æˆ¸ / ä¸‹é–¢å¸‚ã€‡ã€‡" />
                  </div>
                </div>

                <div class="row" style="margin-top:12px">
                  <button class="btn btnGhost" type="button" id="btnGetDistance">è·é›¢ã‚’å–å¾—ï¼ˆGoogleï¼‰</button>
                  <button class="btn btnGhost" type="button" id="btnOpenMaps">Googleãƒãƒƒãƒ—ã‚’é–‹ã</button>
                  <span class="hint" id="mapsStatus">â€»APIã‚­ãƒ¼æœªè¨­å®šãªã‚‰æ‰‹å…¥åŠ›ã§OK</span>
                </div>
              </div>

              <!-- éšæ®µãƒ»ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ï¼ˆé‹æ¬ã®ã¿ï¼‰ -->
              <div style="grid-column:1/-1" id="d_mode_stairs" class="section" data-mode="stairs">
                <div class="hint" style="font-weight:900;margin-bottom:8px">ä»˜å¸¯æ–™é‡‘ï¼ˆéšæ®µãƒ»ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ï¼‰</div>
                <div class="grid">
                  <div>
                    <label>ç©åœ°ï¼šéšæ•°</label>
                    <select id="d_pickFloor">
                      <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
                    </select>
                  </div>
                  <div>
                    <label>ç©åœ°ï¼šã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼</label>
                    <select id="d_pickElev">
                      <option value="yes">ã‚ã‚Š</option>
                      <option value="no">ãªã—ï¼ˆéšæ®µï¼‰</option>
                    </select>
                  </div>
                  <div>
                    <label>å¸åœ°ï¼šéšæ•°</label>
                    <select id="d_dropFloor">
                      <option>1</option><option>2</option><option>3</option><option>4</option><option>5</option>
                    </select>
                  </div>
                  <div>
                    <label>å¸åœ°ï¼šã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼</label>
                    <select id="d_dropElev">
                      <option value="yes">ã‚ã‚Š</option>
                      <option value="no">ãªã—ï¼ˆéšæ®µï¼‰</option>
                    </select>
                  </div>
                </div>
                <div class="smallNote">â€»éšæ®µï¼š2éšä»¥ä¸Šã¯ 1éšä¸ŠãŒã‚‹ã”ã¨ã« +1,100å††ï¼ˆã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ç„¡ã—ã®å ´åˆï¼‰</div>
              </div>

              <!-- è¿½åŠ äººä»¶è²»ï¼ˆãƒ‰ãƒ©ã‚¤ãƒãƒ¼ä»¥å¤–ï¼‰ -->
              <div style="grid-column:1/-1" id="d_mode_labor" class="section">
                <div class="hint" style="font-weight:900;margin-bottom:8px">è¿½åŠ äººä»¶è²»ï¼ˆãƒ‰ãƒ©ã‚¤ãƒãƒ¼ä»¥å¤–ï¼‰</div>
                <div class="grid">
                  <div>
                    <label>è¿½åŠ ä½œæ¥­å“¡ï¼ˆäººæ•°ï¼‰</label>
                    <div class="row" style="flex-wrap:nowrap">
                      <button class="btn btnGhost" type="button" id="d_workersMinus" aria-label="äººæ•°ã‚’æ¸›ã‚‰ã™">ï¼</button>
                      <input id="d_workers" inputmode="numeric" value="0" style="flex:1;text-align:center;font-weight:900" />
                      <button class="btn btnGhost" type="button" id="d_workersPlus" aria-label="äººæ•°ã‚’å¢—ã‚„ã™">ï¼‹</button>
                    </div>
                    <div class="smallNote">ä¾‹ï¼šãƒ‰ãƒ©ã‚¤ãƒãƒ¼ï¼‹åŠ©æ‰‹1å â†’ è¿½åŠ ä½œæ¥­å“¡=1</div>
                  </div>
                  <div>
                    <label>è¿½åŠ ä½œæ¥­æ™‚é–“ï¼ˆæ™‚é–“ï¼‰</label>
                    <div class="row" style="flex-wrap:nowrap">
                      <button class="btn btnGhost" type="button" id="d_wHoursMinus" aria-label="æ™‚é–“ã‚’æ¸›ã‚‰ã™">ï¼</button>
                      <input id="d_wHours" inputmode="decimal" value="0" style="flex:1;text-align:center;font-weight:900" />
                      <button class="btn btnGhost" type="button" id="d_wHoursPlus" aria-label="æ™‚é–“ã‚’å¢—ã‚„ã™">ï¼‹</button>
                    </div>
                    <div class="smallNote">â€»0.5æ™‚é–“åˆ»ã¿ï¼ˆã‚¿ãƒƒãƒ—ã§ç›´æ¥å…¥åŠ›OKï¼‰</div>
                  </div>
                </div>
                <div class="smallNote">â€»è¿½åŠ äººä»¶è²»ï¼š<strong>2,200å††/äººãƒ»æ™‚</strong>ï¼ˆç¨è¾¼ï¼‰</div>
              </div>

              <div style="grid-column:1/-1">
                <label>è£œè¶³ï¼ˆä»»æ„ï¼‰</label>
                <textarea id="d_note" placeholder="ä¾‹ï¼šé‹æ¬ç‰©ã€è²·ã„ç‰©ãƒªã‚¹ãƒˆã€æ•´å‚™å·¥å ´åãªã©"></textarea>
              </div>
            </div>

            <div class="row">
              <button class="btn btnPrimary" id="btnCalcDriving">è¨ˆç®—ã™ã‚‹ï¼ˆé‹ã¶ãƒ»ç§»å‹•ï¼‰</button>
              <span class="hint">çµæœ â†’ LINE/ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã«è‡ªå‹•ã§å…¥ã‚Šã¾ã™</span>
            </div>

            <div class="result" id="resultDriving" aria-live="polite">
              <div class="row" style="justify-content:space-between">
                <span class="planBadge" id="d_badge">é‹ã¶ãƒ»ç§»å‹• è¦‹ç©</span>
                <span class="hint">ç¨è¾¼æ¦‚ç®—</span>
              </div>
              <div class="price" id="d_total">0å††</div>
              <div class="break" id="d_breakdown"></div>

              <div class="section row">
                <button class="btn btnGhost" id="d_copy">å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼</button>
                <button class="btn" id="d_toContact">ä¸‹ã®LINE/ãƒ¡ãƒ¼ãƒ«ã¸</button>
                <button class="btn btnPrimary" id="d_booking" style="display:none">æœ¬å¥‘ç´„ï¼ˆåˆ¥ãƒšãƒ¼ã‚¸ï¼‰ã¸</button>
              </div>

              <p class="smallNote" id="d_legalNote">
                â€»è²·ã„ç‰©ä»£è¡Œã¯åŸºæœ¬ 2,200å††ã€œï¼ˆç›®å®‰ï¼‰ã€‚å•†å“ä»£ã¯å®Ÿè²»ã§ã™ã€‚<br>
                â€»è»Šæ¤œãƒ»æ•´å‚™ã¯æ³•å®šè²»ç”¨ãƒ»æ•´å‚™è²»ãŒåˆ¥é€”ã§ã€æœ€çµ‚è¦‹ç©ã«ãªã‚Šã¾ã™ï¼ˆã“ã“ã¯ä»£è¡Œé‹è»¢ãƒ»æ¬å…¥ç­‰ã®æ¦‚ç®—ï¼‰ã€‚
              </p>
            </div>

            <footer>
              â€»æ¦‚ç®—ã§ã™ã€‚ç¾åœ°çŠ¶æ³ï¼ˆè·ç‰©é‡/é§è»Š/è¿½åŠ ä½œæ¥­ãªã©ï¼‰ã§èª¿æ•´ãŒå…¥ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>
              â€»å½“æ—¥æ±ºæ¸ˆï¼ˆç¾é‡‘/æŒ¯è¾¼ï¼‰ã€‚ç¢ºå®šã¯ä¸‹ã®LINE/ãƒ¡ãƒ¼ãƒ«ã§åˆæ„å¾Œã«æœ¬å¥‘ç´„ã¸ã€‚
            </footer>
          </div>

          <!-- FAQ -->
          <div class="section" id="faq">
            <div class="sectionHead">
              <span class="hint" style="font-weight:700;margin-bottom:8px">ã‚ˆãã‚ã‚‹è³ªå•</span>
              <button type="button" class="helpBtn" aria-label="ã‚ˆãã‚ã‚‹è³ªå•ã®èª¬æ˜" data-help="faq">ï¼Ÿ</button>
            </div>
            <div class="stack">
              <details>
                <summary>æ”¯æ‰•ã„æ–¹æ³•ã¯ï¼Ÿ</summary>
                <div class="smallNote">å½“æ—¥æ±ºæ¸ˆï¼ˆä½œæ¥­å®Œäº†æ™‚ï¼‰ï¼šç¾é‡‘ / æŒ¯è¾¼ã§ã™ã€‚</div>
              </details>
              <details>
                <summary>å‡ºå¼µè²»ã¯ï¼Ÿ</summary>
                <div class="smallNote">20kmåœå†…ã¯ç„¡æ–™ã€‚20kmã‚’è¶…ãˆã‚‹å ´åˆã¯ã€5kmã”ã¨ã« +550å††ï¼ˆç¨è¾¼ï¼‰ã§ã™ã€‚</div>
              </details>
              <details>
                <summary>è‰åˆˆã‚Šã®ã‚´ãƒŸã¯ã©ã†ãªã‚‹ï¼Ÿ</summary>
                <div class="smallNote">ã€Œè¢‹è©°ã‚è¾¼ã€ã¾ã§ã€‚å½“åº—ã¯å›åãƒ»å‡¦åˆ†ã¯è¡Œã„ã¾ã›ã‚“ã€‚ã‚´ãƒŸå‡ºã—ã¯ãŠå®¢æ§˜ã«ãŠé¡˜ã„ã—ã¾ã™ã€‚</div>
              </details>
              <details>
                <summary>ç¯æ²¹ã¯å•†å“ä»£è¾¼ã¿ï¼Ÿ</summary>
                <div class="smallNote">ç¯æ²¹ä»£ï¼ˆå•†å“ä»£ï¼‰ã¯å®Ÿè²»ã§ã™ã€‚ã“ã“ã§ã¯ä½œæ¥­è²»ï¼‹å‡ºå¼µè²»ã®æ¦‚ç®—ã®ã¿è¡¨ç¤ºã—ã¾ã™ã€‚</div>
              </details>
              <details>
                <summary>ç‰‡ä»˜ã‘ã¯å…¨éƒ¨ãªãã›ã‚‹ï¼Ÿ</summary>
                <div class="smallNote">å›åãƒ»å‡¦åˆ†ã¯è¡Œã„ã¾ã›ã‚“ã€‚åˆ†åˆ¥ãƒ»è¢‹è©°ã‚ãƒ»æ’å‡ºã®æ®µå–ã‚Šä½œã‚Šã‚’ä¸­å¿ƒã«ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ï¼ˆè²·å–ãªã—ï¼‰ã€‚</div>
              </details>
              <details>
                <summary>é€£çµ¡æ‰‹æ®µã¯ï¼Ÿ</summary>
                <div class="smallNote">é›»è©±ç•ªå·ã¯éæ²è¼‰ã§ã™ã€‚ãƒšãƒ¼ã‚¸ä¸‹ã®ã€ŒLINEã€ã€Œãƒ¡ãƒ¼ãƒ«ã€ã«ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚</div>
              </details>
            </div>
          </div>

        </div><!-- calcBody -->
      </div><!-- heroRight -->
    </section>

    <!-- é€£çµ¡ï¼ˆãƒ•ãƒƒã‚¿ãƒ¼å´ã«é›†ç´„ï¼‰ -->
    <section class="card" id="contact" style="margin-top:18px">
      <div style="padding:18px;border-bottom:1px solid var(--line);background: linear-gradient(180deg, rgba(212,132,148,.06), transparent);">
        <div class="row" style="justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px">
          <div class="sectionHead" style="margin:0">
            <span style="font-weight:700">é€£çµ¡ï¼ˆLINE / ãƒ¡ãƒ¼ãƒ«ï¼‰</span>
            <button type="button" class="helpBtn" aria-label="é€£çµ¡æ–¹æ³•ã®èª¬æ˜" data-help="contact">ï¼Ÿ</button>
          </div>
          <div class="hint">â€»è¨ˆç®—ã—ãŸè¦‹ç©ãŒè‡ªå‹•ã§æœ¬æ–‡ã«å…¥ã‚Šã¾ã™</div>
        </div>
      </div>

      <div style="padding:18px">
        <div class="section" style="margin-top:0;padding-top:0;border-top:0">
          <div class="row">
            <a class="btn btnLine" id="btnLineOpen" href="#">LINE</a>
            <button class="btn btnMail" id="btnMailJump" type="button">ãƒ¡ãƒ¼ãƒ«</button>
            <button class="btn btnGhost" id="btnCopyLast" type="button">ç›´è¿‘ã®è¦‹ç©ã‚’ã‚³ãƒ”ãƒ¼</button>
          </div>
          <p class="smallNote">
            â€»é›»è©±ç•ªå·ã¯éæ²è¼‰ã§ã™ï¼ˆå±¥æ­´ãŒæ®‹ã‚‹LINE/ãƒ¡ãƒ¼ãƒ«ã‚’å„ªå…ˆï¼‰ã€‚<br>
            â€»å½“æ—¥æ±ºæ¸ˆï¼ˆç¾é‡‘/æŒ¯è¾¼ï¼‰ã€‚ç¢ºå®šã¯åˆæ„å¾Œã«æœ¬å¥‘ç´„ï¼ˆåˆ¥ãƒšãƒ¼ã‚¸ï¼‰ã¸ã€‚
          </p>
        </div>

        <div class="section" id="mailForm">
          <div class="row" style="justify-content:space-between">
            <div style="font-weight:900">ãƒ¡ãƒ¼ãƒ«ï¼ˆç›¸è«‡ç”¨ï¼‰</div>
            <div class="hint">â€»é€ä¿¡ã¯ç«¯æœ«ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ—ãƒªãŒé–‹ãã¾ã™</div>
          </div>

          <div class="grid" style="margin-top:12px">
            <div>
              <label>ãŠåå‰</label>
              <input id="m_name" placeholder="ä¾‹ï¼šå±±ç”° å¤ªéƒ" />
            </div>
            <div>
              <label>è¿”ä¿¡ç”¨ãƒ¡ãƒ¼ãƒ«ï¼ˆä»»æ„ï¼‰</label>
              <input id="m_reply" inputmode="email" placeholder="ä¾‹ï¼šexample@gmail.com" />
            </div>
            <div style="grid-column:1/-1">
              <label>ç›¸è«‡å†…å®¹ï¼ˆè¦‹ç©ã‹ã‚‰è‡ªå‹•ã§å…¥ã‚Šã¾ã™ï¼‰</label>
              <textarea id="m_body" placeholder="ã“ã“ã«ç›¸è«‡å†…å®¹ã‚’æ›¸ã‘ã¾ã™ï¼ˆè¦‹ç©çµæœã‚‚è²¼ã‚Œã¾ã™ï¼‰"></textarea>
            </div>
          </div>

          <div class="section row">
            <button class="btn btnPrimary" id="btnMailSend" type="button">ãƒ¡ãƒ¼ãƒ«ã‚’ä½œæˆã—ã¦é€ã‚‹</button>
            <button class="btn btnGhost" id="btnMailCopy" type="button">æœ¬æ–‡ã‚’ã‚³ãƒ”ãƒ¼</button>
          </div>
        </div>

        <div class="section">
          <div class="hint" style="font-weight:900;margin-bottom:8px">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« / SNSï¼ˆé€£çµ¡æ‰‹æ®µã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰</div>
          <div class="row">
            <a class="btn btnInsta" id="btnInsta" href="#" target="_blank" rel="noopener">
              <span class="icon24" aria-hidden="true">
                <svg viewBox="0 0 24 24" width="18" height="18">
                  <g fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="6" y="6" width="12" height="12" rx="3"></rect>
                    <circle cx="12" cy="12" r="3.2"></circle>
                    <circle cx="16.6" cy="7.4" r="0.8" fill="white" stroke="none"></circle>
                  </g>
                </svg>
              </span>
              Instagram
            </a>
            <a class="btn btnTwitc" id="btnTwit" href="#" target="_blank" rel="noopener">
              <span class="icon24" aria-hidden="true">
                <svg viewBox="0 0 24 24" width="18" height="18">
                  <g fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="6" y="7" width="12" height="10" rx="2"></rect>
                    <path d="M10 17v2"></path>
                    <path d="M14 17v2"></path>
                    <path d="M11 11l4 2-4 2z" fill="white" stroke="none"></path>
                  </g>
                </svg>
              </span>
              TwitCasting
            </a>
          </div>
          <p class="smallNote">è»½è²¨ç‰©TAKEï½œä¸‹é–¢ï½œä»£è¡¨ï¼šæ¾æ°¸ ãŸã‘ã—</p>
        </div>
      </div>
    </section>

    <div class="toast" id="toast">
      <b id="toastTitle">å®Œäº†</b>
      <div id="toastMsg" style="color:var(--muted);font-size:12px;line-height:1.5"></div>
    </div>
  </div>

  <div class="fabTop" id="fabTop">
    <a class="btn btnGhost" href="#estimate">ä¸Šã¸æˆ»ã‚‹</a>
  </div>

  <!-- ãƒ˜ãƒ«ãƒ—èª¬æ˜ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆæœ¬æ–‡ã‹ã‚‰ã®å¼•ç”¨ã®ã¿ï¼‰ -->
  <div class="helpOverlay" id="helpOverlay" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="helpTitle">
    <div class="helpModal" role="document">
      <h3 id="helpTitle">èª¬æ˜</h3>
      <div id="helpContent"></div>
      <button type="button" class="btn btnPrimary closeBtn" id="helpClose">é–‰ã˜ã‚‹</button>
    </div>
  </div>

  <!-- æ—¥ä»˜ãƒ”ãƒƒã‚«ãƒ¼ï¼ˆæ±ºå®šãƒœã‚¿ãƒ³ä»˜ãï¼‰ -->
  <div class="dtOverlay" id="dtOverlay" aria-hidden="true">
    <div class="dtPanel" role="dialog" aria-modal="true" aria-labelledby="dtTitle">
      <div class="dtHead" id="dtTitle">å¸Œæœ›æ—¥æ™‚ã‚’é¸ã¶</div>
      <div class="dtBody">
        <div class="grid">
          <div>
            <label>æ—¥ä»˜</label>
            <input id="dt_date" type="date" />
          </div>
          <div>
            <label>æ™‚é–“</label>
            <input id="dt_time" type="time" step="300" />
            <div class="smallNote">â€»5åˆ†åˆ»ã¿</div>
          </div>
        </div>
        <div class="smallNote" style="margin-top:10px">
          ã€Œæ±ºå®šã€ã‚’æŠ¼ã™ã¨æ—¥æ™‚ãŒç¢ºå®šã—ã€å…¥åŠ›æ¬„ãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¾ã™ï¼ˆå¾Œã‹ã‚‰å¤‰æ›´ã‚‚ã§ãã¾ã™ï¼‰ã€‚
        </div>
      </div>
      <div class="dtFoot">
        <button class="btn btnGhost" type="button" id="dtCancel">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <button class="btn btnPrimary" type="button" id="dtConfirm">æ±ºå®š</button>
      </div>
    </div>
  </div>

<script>
  // =========================
  // è¨­å®š
  // =========================
  const CFG = {
    BOOKING_PAGE_URL: "./booking.html",
    PHILOSOPHY_PAGE_URL: "./philosophy.html",

    LINE_URL: "https://line.me/R/ti/p/%40277rcesk", // å‹ã ã¡è¿½åŠ ç”¨ï¼ˆæœ¬æ–‡æµã—è¾¼ã¿ã¯ share URL ã‚’ä½¿ã„ã¾ã™ï¼‰
    EMAIL_TO: "takeshimonoseki@gmail.com",

    INSTAGRAM_URL: "https://www.instagram.com/tkc94193614/",
    TWITCASTING_URL: "https://twitcasting.tv/c:keikamotsutake",

  };

  // =========================
  // æ–™é‡‘ï¼ˆã™ã¹ã¦ç¨è¾¼ï¼‰
  // =========================
  const PRICE = {
    travelFreeKm: 20,
    travelStepKm: 5,
    travelStepYen: 550,

    lightPerHour: 2200,
    hardPerHour: 3300,

    // è‰åˆˆã‚Šï¼ˆç›¸å ´ã®ç´„8å‰²ç›®å®‰ï¼‰
    grassRatePerM2: 145,
    grassMinFee: 5500,

    // ç¯æ²¹ï¼ˆ18Lãƒãƒªç¼¶ï¼‰
    keroseneBaseFee: 2200,
    kerosenePerExtraCan: 550,

    // ç‰‡ä»˜ã‘ï¼ˆç›¸è«‡ãƒ»è²·å–ãªã—ï¼‰è»Šä¸¡è²»
    vanFeePerUnit: 3300,
    estateBaseStaffFor1Van: 1,
    estateBaseStaffFor2Van: 2,
    estateMaxStaffFor1Van: 2,
    estateMaxStaffFor2Van: 4,

    // é‹ã¶ãƒ»ç§»å‹•ï¼ˆåŸºæœ¬æ–™é‡‘ï¼‰
    haulBaseFee: 3300,
    shoppingBaseFee: 2200,
    carSupportBaseFee: 3300,

    // éšæ®µä»˜å¸¯ï¼ˆã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ç„¡ã—ã®å ´åˆï¼‰
    stairsPerFloor: 1100,

    // è¿½åŠ äººä»¶è²»ï¼ˆãƒ‰ãƒ©ã‚¤ãƒãƒ¼ä»¥å¤–ï¼‰
    extraLaborPerHour: 2200,

    // Webåˆ¶ä½œï¼ˆè²·ã„åˆ‡ã‚Šæœ€ä½ï¼‰
    webBaseMin: 33000
  };

  // =========================
  // ãƒªãƒ³ã‚¯åæ˜ 
  // =========================
  document.getElementById("btnInsta").href = CFG.INSTAGRAM_URL;
  document.getElementById("btnTwit").href = CFG.TWITCASTING_URL;

  // =========================
  // å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
  // =========================
  function showToast(title, msg){
    const t = document.getElementById("toast");
    document.getElementById("toastTitle").innerText = title;
    document.getElementById("toastMsg").innerText = msg || "";
    t.style.display = "block";
    clearTimeout(showToast._timer);
    showToast._timer = setTimeout(()=>{ t.style.display="none"; }, 2600);
  }

  function escapeHtml(s){
    return String(s ?? "")
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  function z2h(str){
    if(str == null) return "";
    return String(str)
      .replace(/[ï¼-ï¼™]/g, s => String.fromCharCode(s.charCodeAt(0) - 0xFEE0))
      .replace(/[ï¼ã€‚]/g, ".")
      .replace(/[ãƒ¼âˆ’â€•]/g, "-")
      .replace(/[ï¼Œã€]/g, ",")
      .trim();
  }

  function num(v, fallback=0){
    const s = z2h(v);
    const n = parseFloat(s);
    return Number.isFinite(n) ? n : fallback;
  }
  function int(v, fallback=0){
    const s = z2h(v);
    const n = parseInt(s, 10);
    return Number.isFinite(n) ? n : fallback;
  }
  function yen(n){ return `${Math.floor(n).toLocaleString()}å††`; }

  function roundToHalfHourHours(x){
    const v = Math.max(0, Number(x) || 0);
    return Math.round(v * 2) / 2;
  }

  async function copyToClipboard(text){
    try{
      await navigator.clipboard.writeText(text);
      return true;
    }catch(e){
      const ta = document.createElement("textarea");
      ta.value = text;
      ta.style.position="fixed";
      ta.style.left="-9999px";
      document.body.appendChild(ta);
      ta.select();
      const ok = document.execCommand("copy");
      document.body.removeChild(ta);
      return ok;
    }
  }

  function renderBreakdown(el, rows){
    el.innerHTML = rows.map(r=>{
      return `<div class="breakRow"><span>${escapeHtml(r.k)}</span><strong>${escapeHtml(r.v)}</strong></div>`;
    }).join("");
  }

  function pad2(n){ return String(n).padStart(2,"0"); }
  function makeReservationId(prefix){
    const d = new Date();
    const y = d.getFullYear();
    const mo = pad2(d.getMonth()+1);
    const da = pad2(d.getDate());
    const hh = pad2(d.getHours());
    const mm = pad2(d.getMinutes());
    const rand = Math.random().toString(36).slice(2,6).toUpperCase();
    return `TK-${y}${mo}${da}-${hh}${mm}-${prefix}-${rand}`;
  }

  // å‡ºå¼µè²»ï¼š20kmã¾ã§ç„¡æ–™ã€è¶…éã¯5kmã”ã¨+550å††
  function calcTravelFee(distanceKm){
    const km = Math.max(0, num(distanceKm, 0));
    if(km <= PRICE.travelFreeKm) return { fee: 0, note: `${PRICE.travelFreeKm}kmåœå†…ï¼šç„¡æ–™` };
    const over = km - PRICE.travelFreeKm;
    const steps = Math.ceil(over / PRICE.travelStepKm);
    const fee = steps * PRICE.travelStepYen;
    return { fee, note: `è¶…é ${over.toFixed(1)}km â†’ ${steps}æ®µï¼ˆ${PRICE.travelStepKm}kmã”ã¨ï¼‰` };
  }

  function calcHourlyFee(hours, type, people=1){
    const h = roundToHalfHourHours(hours);
    const p = Math.max(1, int(people, 1));
    const rate = (type === "hard") ? PRICE.hardPerHour : PRICE.lightPerHour;
    return { hours: h, people: p, rate, fee: h * rate * p };
  }

  function calcStairsFee(floor, hasElev){
    const f = Math.max(1, int(floor, 1));
    if(hasElev) return 0;
    return Math.max(0, f - 1) * PRICE.stairsPerFloor;
  }

  function bounceShow(btn){
    btn.style.display = "inline-flex";
    btn.classList.remove("bounce","pulseGlow");
    void btn.offsetWidth;
    btn.classList.add("bounce","pulseGlow");
  }

  function buildMailto(subject, body){
    const s = encodeURIComponent(subject || "è»½è²¨ç‰©TAKE ã”ç›¸è«‡");
    const b = encodeURIComponent((body || "").slice(0, 1800));
    return `mailto:${CFG.EMAIL_TO}?subject=${s}&body=${b}`;
  }

  // ãƒã‚¤ãƒ©ã‚¤ãƒˆï¼ˆå…¥åŠ›ãŒè‡ªå‹•ã‚»ãƒƒãƒˆã•ã‚ŒãŸã¨ä¼ãˆã‚‹ï¼‰
  function flashElements(els){
    (els || []).forEach(el=>{
      if(!el) return;
      el.classList.remove("flash");
      void el.offsetWidth;
      el.classList.add("flash");
      el.addEventListener("animationend", ()=>el.classList.remove("flash"), { once:true });
    });
  }

  // =========================
  // ã‚«ãƒ†ã‚´ãƒªåˆ‡ã‚Šæ›¿ãˆ
  // =========================
  const tabHelping = document.getElementById("tabHelping");
  const tabDriving = document.getElementById("tabDriving");
  const panelHelping = document.getElementById("panelHelping");
  const panelDriving = document.getElementById("panelDriving");

  function setCategory(which){
    const isH = which === "helping";
    tabHelping.setAttribute("aria-selected", isH ? "true" : "false");
    tabDriving.setAttribute("aria-selected", !isH ? "true" : "false");
    panelHelping.style.display = isH ? "flex" : "none";
    panelDriving.style.display = !isH ? "flex" : "none";
  }
  tabHelping.addEventListener("click", ()=>setCategory("helping"));
  tabDriving.addEventListener("click", ()=>setCategory("driving"));

  // =========================
  // ã‚¹ãƒ†ãƒƒãƒ‘ãƒ¼ï¼ˆï¼‹/ï¼ï¼‰
  // =========================
  function bindStepper({ minusId, plusId, inputId, step, min=0, max=999, isInt=false }){
    const minus = document.getElementById(minusId);
    const plus = document.getElementById(plusId);
    const input = document.getElementById(inputId);

    function getVal(){
      const v = isInt ? int(input.value, min) : num(input.value, min);
      return Number.isFinite(v) ? v : min;
    }
    function setVal(v){
      const clamped = Math.max(min, Math.min(max, v));
      input.value = isInt ? String(Math.round(clamped)) : String(clamped);
    }

    minus.addEventListener("click", ()=>{
      const v = getVal();
      const next = isInt ? (v - step) : (roundToHalfHourHours(v - step));
      setVal(next);
    });
    plus.addEventListener("click", ()=>{
      const v = getVal();
      const next = isInt ? (v + step) : (roundToHalfHourHours(v + step));
      setVal(next);
    });

    input.addEventListener("input", ()=>{
      const before = input.value;
      const after = z2h(before);
      if(before !== after) input.value = after;
    });
    input.addEventListener("blur", ()=>{
      const v = getVal();
      const normalized = isInt ? Math.round(v) : roundToHalfHourHours(v);
      setVal(normalized);
    });
  }

  // ç¯æ²¹ãƒãƒªç¼¶
  bindStepper({ minusId:"k_cansMinus", plusId:"k_cansPlus", inputId:"k_cans", step:1, min:1, max:20, isInt:true });

  // ç‰‡ä»˜ã‘ï¼šäººæ•°/æ™‚é–“
  bindStepper({ minusId:"e_staffMinus", plusId:"e_staffPlus", inputId:"e_staff", step:1, min:1, max:4, isInt:true });
  bindStepper({ minusId:"e_hMinus", plusId:"e_hPlus", inputId:"e_hours", step:0.5, min:0.5, max:24, isInt:false });

  // å…±é€šï¼šä½œæ¥­ï¼ˆæ‰‹ä¼ã†ãƒ»ä½œæ¥­ï¼‰
  bindStepper({ minusId:"h_peopleMinus", plusId:"h_peoplePlus", inputId:"h_people", step:1, min:1, max:6, isInt:true });
  bindStepper({ minusId:"h_hMinus", plusId:"h_hPlus", inputId:"h_hours", step:0.5, min:0.5, max:24, isInt:false });

  // é‹ã¶ãƒ»ç§»å‹•ï¼šè¿½åŠ ä½œæ¥­å“¡/æ™‚é–“ï¼ˆãƒ‰ãƒ©ã‚¤ãƒãƒ¼ä»¥å¤–ï¼‰
  bindStepper({ minusId:"d_workersMinus", plusId:"d_workersPlus", inputId:"d_workers", step:1, min:0, max:10, isInt:true });
  bindStepper({ minusId:"d_wHoursMinus", plusId:"d_wHoursPlus", inputId:"d_wHours", step:0.5, min:0, max:24, isInt:false });

  // =========================
  // æ—¥æ™‚ï¼šæ±ºå®šãƒœã‚¿ãƒ³ï¼ˆç¢ºå®šã—ãŸã‚‰ãƒ­ãƒƒã‚¯ï¼‰
  // + ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ï¼ˆæ±ºå®šãƒœã‚¿ãƒ³ä»˜ããƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰
  // =========================
  function createDatetimeController({ inputId, btnId, statusId }){
    const input = document.getElementById(inputId);
    const btn = document.getElementById(btnId);
    const status = document.getElementById(statusId);

    let locked = false;

    function lock(){
      if(!input.value){
        showToast("æ—¥æ™‚æœªå…¥åŠ›", "æ—¥æ™‚ã‚’é¸æŠã—ã¦ã‹ã‚‰ã€Œæ±ºå®šã€ã‚’æŠ¼ã—ã¦ãã ã•ã„");
        return false;
      }
      locked = true;
      input.setAttribute("disabled", "true");
      btn.innerText = "å¤‰æ›´";
      status.innerText = `æ±ºå®šï¼š${input.value.replace("T"," ")}ï¼ˆå¤‰æ›´ã§ãã¾ã™ï¼‰`;
      return true;
    }
    function unlock(){
      locked = false;
      input.removeAttribute("disabled");
      btn.innerText = "æ±ºå®š";
      status.innerText = "â€»æ—¥æ™‚ã¯æœªæ±ºå®šã§ã‚‚OKï¼ˆæ±ºå®šã™ã‚‹ã¨å›ºå®šã•ã‚Œã¾ã™ï¼‰";
      return true;
    }
    function toggle(){
      if(!locked) {
        const ok = lock();
        if(ok) showToast("æ—¥æ™‚ã‚’æ±ºå®š", "ã“ã®å†…å®¹ã§ç›¸è«‡ã§ãã¾ã™");
      } else {
        unlock();
        showToast("å¤‰æ›´ã§ãã¾ã™", "æ—¥æ™‚ã‚’é¸ã³ç›´ã—ã¦ãã ã•ã„");
      }
    }
    function setValueISO(iso){
      input.value = iso || "";
    }
    function getValue(){
      return input.value ? input.value.replace("T"," ") : "";
    }
    function isLocked(){ return locked; }

    btn.addEventListener("click", toggle);

    return { input, lock, unlock, toggle, setValueISO, getValue, isLocked };
  }

  const H_DT = createDatetimeController({ inputId:"h_datetime", btnId:"h_dtConfirm", statusId:"h_dtStatus" });
  const D_DT = createDatetimeController({ inputId:"d_datetime", btnId:"d_dtConfirm", statusId:"d_dtStatus" });

  // ãƒ¢ãƒ¼ãƒ€ãƒ«æœ¬ä½“
  const dtOverlay = document.getElementById("dtOverlay");
  const dtDate = document.getElementById("dt_date");
  const dtTime = document.getElementById("dt_time");
  const dtCancel = document.getElementById("dtCancel");
  const dtConfirm = document.getElementById("dtConfirm");

  let activeDT = null; // H_DT or D_DT

  function openDtModal(controller){
    activeDT = controller;

    // åˆæœŸå€¤ï¼šæ—¢å­˜ãŒã‚ã‚Œã°ãã‚Œã€ãªã‘ã‚Œã°ã€Œä»Šæ—¥+1æ—¥ 13:00ã€
    let iso = controller.input.value;
    if(!iso){
      const now = new Date();
      now.setDate(now.getDate() + 1);
      now.setHours(13,0,0,0);
      iso = `${now.getFullYear()}-${pad2(now.getMonth()+1)}-${pad2(now.getDate())}T${pad2(now.getHours())}:${pad2(now.getMinutes())}`;
    }
    const [d,t] = iso.split("T");
    dtDate.value = d;
    dtTime.value = t ? t.slice(0,5) : "13:00";

    dtOverlay.style.display = "flex";
    dtOverlay.setAttribute("aria-hidden","false");
  }

  function closeDtModal(){
    dtOverlay.style.display = "none";
    dtOverlay.setAttribute("aria-hidden","true");
    activeDT = null;
  }

  dtCancel.addEventListener("click", closeDtModal);
  dtOverlay.addEventListener("click", (e)=>{
    if(e.target === dtOverlay) closeDtModal();
  });

  dtConfirm.addEventListener("click", ()=>{
    if(!activeDT) return;
    if(!dtDate.value || !dtTime.value){
      showToast("å…¥åŠ›ä¸è¶³", "æ—¥ä»˜ã¨æ™‚é–“ã‚’å…¥ã‚Œã¦ãã ã•ã„");
      return;
    }
    const iso = `${dtDate.value}T${dtTime.value}`;
    activeDT.setValueISO(iso);

    // ã“ã“ã§ã€Œæ±ºå®šã€ã‚’å®Œçµã•ã›ã‚‹ï¼ˆãƒ­ãƒƒã‚¯ï¼‰
    activeDT.unlock();
    const ok = activeDT.lock();
    closeDtModal();

    if(ok) showToast("æ—¥æ™‚ã‚’æ±ºå®š", `${iso.replace("T"," ")} ã«å›ºå®šã—ã¾ã—ãŸ`);
  });

  document.getElementById("h_dtPick").addEventListener("click", ()=>openDtModal(H_DT));
  document.getElementById("d_dtPick").addEventListener("click", ()=>openDtModal(D_DT));

  // =========================
  // è‰åˆˆã‚Šï¼šã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼åŒæœŸ
  // =========================
  document.getElementById("g_rateLabel").innerText = `${PRICE.grassRatePerM2}å††/ã¡`;

  const gArea = document.getElementById("g_area");
  const gRange = document.getElementById("g_areaRange");

  function syncGrassFromInput(){
    const v = Math.max(0, num(gArea.value, 0));
    gArea.value = String(v);
    gRange.value = String(Math.max(0, Math.min(300, Math.round(v/5)*5)));
  }
  function syncGrassFromRange(){
    const v = int(gRange.value, 0);
    gArea.value = String(v);
  }
  gArea.addEventListener("input", ()=>{ const before=gArea.value; const after=z2h(before); if(before!==after) gArea.value=after; });
  gArea.addEventListener("blur", syncGrassFromInput);
  gRange.addEventListener("input", syncGrassFromRange);

  // =========================
  // æ‰‹ä¼ã†ãƒ»ä½œæ¥­ï¼šãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿
  // =========================
  let helpingType = "light";
  function setHelpingType(t){
    helpingType = t;
    document.getElementById("h_typeLight").setAttribute("aria-selected", t==="light" ? "true":"false");
    document.getElementById("h_typeHard").setAttribute("aria-selected", t==="hard" ? "true":"false");
  }
  document.getElementById("h_typeLight").addEventListener("click", ()=>setHelpingType("light"));
  document.getElementById("h_typeHard").addEventListener("click", ()=>setHelpingType("hard"));

  function showHelpingMode(serviceKey){
    const modes = ["grass","kerosene","estate","hourly","web"];
    modes.forEach(m=>{
      const el = document.getElementById(`h_mode_${m}`);
      if(!el) return;
      el.style.display = "none";
    });

    if(serviceKey === "grass"){
      document.getElementById("h_mode_grass").style.display = "block";
      return;
    }
    if(serviceKey === "kerosene"){
      document.getElementById("h_mode_kerosene").style.display = "block";
      return;
    }
    if(serviceKey === "estate"){
      document.getElementById("h_mode_estate").style.display = "block";
      syncEstateDefaults();
      return;
    }
    if(serviceKey === "web"){
      document.getElementById("h_mode_web").style.display = "block";
      return;
    }
    document.getElementById("h_mode_hourly").style.display = "block";
    if(serviceKey === "hard") setHelpingType("hard");
    if(serviceKey === "light") setHelpingType("light");
  }

  function syncEstateDefaults(){
    const vans = int(document.getElementById("e_vans").value, 1);
    const heavy = int(document.getElementById("e_heavy").value, 0);
    const base = (vans === 1) ? PRICE.estateBaseStaffFor1Van : PRICE.estateBaseStaffFor2Van;
    const max = (vans === 1) ? PRICE.estateMaxStaffFor1Van : PRICE.estateMaxStaffFor2Van;

    let staff = int(document.getElementById("e_staff").value, base);
    const recommended = Math.min(max, base + (heavy ? 1 : 0));

    if(staff < base || staff > max) staff = recommended;
    document.getElementById("e_staff").value = String(staff);

    document.getElementById("e_staffHint").innerText =
      `â€»${vans}å°=åŸºæœ¬${base}åï¼ˆæœ€å¤§${max}åï¼‰ã€‚é‡é‡ç‰©ãŒã‚ã‚‹ã¨å¢—å“¡æ¨å¥¨ï¼š${recommended}å`;
  }

  document.getElementById("e_vans").addEventListener("change", syncEstateDefaults);
  document.getElementById("e_heavy").addEventListener("change", syncEstateDefaults);

  const hService = document.getElementById("h_service");
  hService.addEventListener("change", ()=>showHelpingMode(hService.value));
  showHelpingMode(hService.value);

  // =========================
  // é‹ã¶ãƒ»ç§»å‹•ï¼šã‚µãƒ¼ãƒ“ã‚¹ã§è¡¨ç¤ºèª¿æ•´
  // =========================
  function syncDrivingByService(){
    const s = document.getElementById("d_service").value;
    const hint = document.getElementById("d_serviceHint");

    const haulBlock = document.getElementById("d_mode_haul");
    const stairsBlock = document.getElementById("d_mode_stairs");

    if(s === "haul"){
      haulBlock.style.display = "block";
      stairsBlock.style.display = "block";
      hint.innerText = "â€»è·é›¢ãƒ»éšæ®µï¼ˆã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ç„¡ã—ï¼‰ãƒ»è»Šä¸¡å°æ•°ãƒ»è¿½åŠ äººå“¡ã§å¤‰ã‚ã‚Šã¾ã™";
      return;
    }

    haulBlock.style.display = "none";
    stairsBlock.style.display = "none";

    if(s === "shopping"){
      hint.innerText = `â€»åŸºæœ¬ ${yen(PRICE.shoppingBaseFee)}ã€œï¼ˆç›®å®‰ï¼‰ï¼‹å‡ºå¼µè²»ï¼ˆ20kmã¾ã§ç„¡æ–™ï¼‰ï¼‹è»Šä¸¡å°æ•°ï¼ˆ2å°ã¯èµ°è¡Œåˆ†Ã—2ï¼‰`;
      return;
    }
    if(s === "carSupport"){
      hint.innerText = `â€»åŸºæœ¬ ${yen(PRICE.carSupportBaseFee)}ï¼ˆç›®å®‰ï¼‰ï¼‹å‡ºå¼µè²»ã€‚æ³•å®šè²»ç”¨ãƒ»æ•´å‚™è²»ã¯åˆ¥é€”ï¼ˆæœ€çµ‚è¦‹ç©ï¼‰`;
      return;
    }
  }
  document.getElementById("d_service").addEventListener("change", syncDrivingByService);
  syncDrivingByService();

  document.getElementById("mapsStatus").innerText = "â€»è·é›¢ã¯æ‰‹å…¥åŠ›ã§ã”å…¥åŠ›ãã ã•ã„";
  document.getElementById("btnGetDistance").addEventListener("click", ()=>{
    showToast("è·é›¢ã®å…¥åŠ›", "ç©åœ°ãƒ»å¸åœ°ã®è·é›¢ï¼ˆkmï¼‰ã‚’æ‰‹å…¥åŠ›ã—ã¦ãã ã•ã„");
  });
  document.getElementById("btnOpenMaps").addEventListener("click", ()=>{
    showToast("è·é›¢ã®å…¥åŠ›", "ç©åœ°ãƒ»å¸åœ°ã‚’ç¢ºèªã®ã†ãˆã€è·é›¢ï¼ˆkmï¼‰ã‚’æ‰‹å…¥åŠ›ã—ã¦ãã ã•ã„");
  });

  // =========================
  // å·¦ã‚¯ãƒªãƒƒã‚¯ â†’ å³ã«åæ˜ ï¼ˆå·¦å³é€£å‹• + ãƒã‚¤ãƒ©ã‚¤ãƒˆï¼‰
  // =========================
  function applyPreset(key){
    document.getElementById("estimate").scrollIntoView({ behavior:"smooth", block:"start" });

    if(key === "grass"){
      setCategory("helping");
      document.getElementById("h_service").value = "grass";
      showHelpingMode("grass");
      document.getElementById("g_area").value = "30";
      document.getElementById("g_areaRange").value = "30";

      flashElements([
        document.getElementById("tabHelping"),
        document.getElementById("h_service"),
        document.getElementById("h_mode_grass"),
        document.getElementById("g_area"),
        document.getElementById("g_areaRange")
      ]);

      showToast("å³ã«åæ˜ ", "è‰åˆˆã‚Šï¼ˆé¢ç©ï¼‰ã«ã‚»ãƒƒãƒˆã—ã¾ã—ãŸ");
      return;
    }

    if(key === "kerosene"){
      setCategory("helping");
      document.getElementById("h_service").value = "kerosene";
      showHelpingMode("kerosene");
      document.getElementById("k_cans").value = "1";

      flashElements([
        document.getElementById("tabHelping"),
        document.getElementById("h_service"),
        document.getElementById("h_mode_kerosene"),
        document.getElementById("k_cans")
      ]);

      showToast("å³ã«åæ˜ ", "ç¯æ²¹ï¼ˆãƒãƒªç¼¶æ•°ï¼‰ã«ã‚»ãƒƒãƒˆã—ã¾ã—ãŸ");
      return;
    }

    if(key === "estate"){
      setCategory("helping");
      document.getElementById("h_service").value = "estate";
      showHelpingMode("estate");
      document.getElementById("e_vans").value = "1";
      document.getElementById("e_heavy").value = "0";
      document.getElementById("e_hours").value = "2";
      syncEstateDefaults();

      flashElements([
        document.getElementById("tabHelping"),
        document.getElementById("h_service"),
        document.getElementById("h_mode_estate"),
        document.getElementById("e_vans"),
        document.getElementById("e_staff"),
        document.getElementById("e_hours")
      ]);

      showToast("å³ã«åæ˜ ", "ç‰‡ä»˜ã‘ç›¸è«‡ï¼ˆè²·å–ãªã—ï¼‰ã«ã‚»ãƒƒãƒˆã—ã¾ã—ãŸ");
      return;
    }

    if(key === "web"){
      setCategory("helping");
      document.getElementById("h_service").value = "web";
      showHelpingMode("web");

      flashElements([
        document.getElementById("tabHelping"),
        document.getElementById("h_service"),
        document.getElementById("h_mode_web")
      ]);

      showToast("å³ã«åæ˜ ", "ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸åˆ¶ä½œã«ã‚»ãƒƒãƒˆã—ã¾ã—ãŸ");
      return;
    }

    if(key === "haul"){
      setCategory("driving");
      document.getElementById("d_service").value = "haul";
      syncDrivingByService();
      document.getElementById("d_vans").value = "1";
      document.getElementById("d_pickFloor").value = "1";
      document.getElementById("d_dropFloor").value = "1";
      document.getElementById("d_pickElev").value = "yes";
      document.getElementById("d_dropElev").value = "yes";

      flashElements([
        document.getElementById("tabDriving"),
        document.getElementById("d_service"),
        document.getElementById("d_vansWrap"),
        document.getElementById("d_mode_haul"),
        document.getElementById("d_mode_stairs"),
        document.getElementById("d_mode_labor")
      ]);

      showToast("å³ã«åæ˜ ", "é‹æ¬ï¼ˆè·é›¢ï¼†éšæ®µï¼‰ã«ã‚»ãƒƒãƒˆã—ã¾ã—ãŸ");
      return;
    }

    if(key === "shopping"){
      setCategory("driving");
      document.getElementById("d_service").value = "shopping";
      syncDrivingByService();
      document.getElementById("d_vans").value = "1";
      document.getElementById("d_workers").value = "0";
      document.getElementById("d_wHours").value = "0";

      flashElements([
        document.getElementById("tabDriving"),
        document.getElementById("d_service"),
        document.getElementById("d_vansWrap"),
        document.getElementById("d_mode_labor")
      ]);

      showToast("å³ã«åæ˜ ", "è²·ã„ç‰©ä»£è¡Œï¼ˆ2,200å††ã€œï¼‰ã«ã‚»ãƒƒãƒˆã—ã¾ã—ãŸ");
      return;
    }

    if(key === "carSupport"){
      setCategory("driving");
      document.getElementById("d_service").value = "carSupport";
      syncDrivingByService();
      document.getElementById("d_vans").value = "1";
      document.getElementById("d_workers").value = "0";
      document.getElementById("d_wHours").value = "0";

      flashElements([
        document.getElementById("tabDriving"),
        document.getElementById("d_service"),
        document.getElementById("d_vansWrap"),
        document.getElementById("d_mode_labor")
      ]);

      showToast("å³ã«åæ˜ ", "è»Šæ¤œãƒ»æ•´å‚™ï¼ˆä»£è¡Œï¼‰ã«ã‚»ãƒƒãƒˆã—ã¾ã—ãŸ");
      return;
    }

    showToast("åæ˜ ã§ãã¾ã›ã‚“", "ã“ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯æœªè¨­å®šã§ã™");
  }

  document.querySelectorAll("[data-preset]").forEach(el=>{
    el.addEventListener("click", ()=>{
      const key = el.getAttribute("data-preset");
      applyPreset(key);
    });
  });

  // =========================
  // ç›´è¿‘ã®è¦‹ç©ãƒ†ã‚­ã‚¹ãƒˆï¼ˆãƒ•ãƒƒã‚¿ãƒ¼ã¸è‡ªå‹•åæ˜ ï¼‰
  // =========================
  let lastQuoteText = "";
  let lastHelping = null;
  let lastDriving = null;

  function setMessageBody(text){
    lastQuoteText = text || "";
    if(lastQuoteText){
      document.getElementById("m_body").value = lastQuoteText; // â˜…è¨ˆç®—æ™‚ç‚¹ã§ç¢ºå®Ÿã«æµã—è¾¼ã‚€
    }
  }

  function moveToContactAndFill(text){
    setMessageBody(text || lastQuoteText || "");
    document.getElementById("contact").scrollIntoView({ behavior:"smooth", block:"start" });
  }

  // =========================
  // ã‚³ãƒ”ãƒ¼æ–‡é¢ï¼ˆã‚µãƒ¼ãƒ“ã‚¹åˆ¥ï¼‰
  // =========================
  function buildHelpingCopy(p){
    const id = makeReservationId("help");
    const lines = [];
    lines.push("ã€è¦‹ç©ï½œæ‰‹ä¼ã†ãƒ»ä½œæ¥­ï½œè»½è²¨ç‰©TAKEã€‘");
    lines.push(`äºˆç´„IDï¼š${id}`);
    lines.push(`ã‚µãƒ¼ãƒ“ã‚¹ï¼š${p.serviceLabel}`);
    lines.push(`è·é›¢ï¼š${p.km}km`);
    lines.push(`å‡ºå¼µè²»ï¼š${yen(p.travelFee)}ï¼ˆ${p.travelNote}ï¼‰`);
    if(p.datetime) lines.push(`å¸Œæœ›æ—¥æ™‚ï¼š${p.datetime}`);
    if(p.note) lines.push(`è£œè¶³ï¼š${p.note}`);
    lines.push("â€”");

    if(p.serviceKey === "grass"){
      lines.push(`åºƒã•ï¼š${p.areaM2}ã¡`);
      lines.push(`è‰åˆˆã‚Šï¼š${yen(p.grassFee)}ï¼ˆ${PRICE.grassRatePerM2}å††/ã¡ï½œæœ€ä½${yen(PRICE.grassMinFee)}ï¼‰`);
      lines.push(`åˆè¨ˆï¼š${yen(p.total)}ï¼ˆç¨è¾¼æ¦‚ç®—ï¼‰`);
      lines.push("â€”");
      lines.push("â€»è‰åˆˆã‚Šã¯ã€Œè¢‹è©°ã‚è¾¼ã€ã€‚å›åãƒ»æŒã¡å¸°ã‚Šãƒ»å‡¦åˆ†ã¯è¡Œã„ã¾ã›ã‚“ï¼ˆã‚´ãƒŸå‡ºã—ã¯ãŠå®¢æ§˜ã¸ï¼‰ã€‚");
      lines.push("ç¢ºå®šï¼šLINE/ãƒ¡ãƒ¼ãƒ«ã§ç›¸è«‡â†’åˆæ„å¾Œã«æœ¬å¥‘ç´„ã¸");
      lines.push("æ”¯æ‰•ã„ï¼šå½“æ—¥æ±ºæ¸ˆï¼ˆç¾é‡‘/æŒ¯è¾¼ï¼‰");
      return { id, text: lines.join("\n") };
    }

    if(p.serviceKey === "kerosene"){
      lines.push(`18Lãƒãƒªç¼¶ï¼š${p.cans}å€‹`);
      lines.push(`ç¯æ²¹ä½œæ¥­ï¼š${yen(p.keroseneFee)}ï¼ˆåŸºæœ¬${yen(PRICE.keroseneBaseFee)} + è¿½åŠ Ã—${yen(PRICE.kerosenePerExtraCan)}ï¼‰`);
      lines.push(`åˆè¨ˆï¼š${yen(p.total)}ï¼ˆç¨è¾¼æ¦‚ç®—ï¼‰`);
      lines.push("â€”");
      lines.push("â€»ç¯æ²¹ä»£ï¼ˆå•†å“ä»£ï¼‰ã¯å®Ÿè²»ã§ã™ï¼ˆã“ã“ã§ã¯å«ã‚ã¾ã›ã‚“ï¼‰ã€‚");
      lines.push("ç¢ºå®šï¼šLINE/ãƒ¡ãƒ¼ãƒ«ã§ç›¸è«‡â†’åˆæ„å¾Œã«æœ¬å¥‘ç´„ã¸");
      lines.push("æ”¯æ‰•ã„ï¼šå½“æ—¥æ±ºæ¸ˆï¼ˆç¾é‡‘/æŒ¯è¾¼ï¼‰");
      return { id, text: lines.join("\n") };
    }

    if(p.serviceKey === "estate"){
      lines.push(`è»Šä¸¡ï¼š${p.vans}å°ï¼ˆè»Šä¸¡è²» ${yen(p.vanFee)}ï¼‰`);
      lines.push(`ã‚¹ã‚¿ãƒƒãƒ•ï¼š${p.staff}å / ä½œæ¥­ï¼š${p.hours}æ™‚é–“`);
      lines.push(`ä½œæ¥­è²»ï¼š${yen(p.workFee)}ï¼ˆå†…è¨³ã¯è¦‹ç©æ¬„å‚ç…§ï¼‰`);
      lines.push(`åˆè¨ˆï¼š${yen(p.total)}ï¼ˆç¨è¾¼æ¦‚ç®—ï¼‰`);
      lines.push("â€”");
      lines.push("â€»åç§°ã¯ã€Œç›¸è«‡ï¼ˆè²·å–ãªã—ï¼‰ã€ã§ã™ã€‚å›åãƒ»å‡¦åˆ†ã¯è¡Œã„ã¾ã›ã‚“ï¼ˆåˆ†åˆ¥ãƒ»è¢‹è©°ã‚ãƒ»æ’å‡ºæ®µå–ã‚Šä¸­å¿ƒï¼‰ã€‚");
      lines.push("ç¢ºå®šï¼šLINE/ãƒ¡ãƒ¼ãƒ«ã§ç›¸è«‡â†’åˆæ„å¾Œã«æœ¬å¥‘ç´„ã¸");
      lines.push("æ”¯æ‰•ã„ï¼šå½“æ—¥æ±ºæ¸ˆï¼ˆç¾é‡‘/æŒ¯è¾¼ï¼‰");
      return { id, text: lines.join("\n") };
    }

    if(p.serviceKey === "web"){
      lines.push(`åˆ¶ä½œè²»ï¼ˆæœ€ä½ï¼‰ï¼š${yen(PRICE.webBaseMin)}ï¼ˆè²·ã„åˆ‡ã‚Šï¼‰`);
      lines.push(`åˆè¨ˆï¼š${yen(p.total)}ï¼ˆç¨è¾¼æ¦‚ç®—ï¼‰`);
      lines.push("â€”");
      lines.push("â€»å†…å®¹ã§èª¿æ•´ã—ã¾ã™ï¼ˆãƒšãƒ¼ã‚¸æ•°/æ§‹æˆ/å†™çœŸãªã©ï¼‰ã€‚");
      lines.push("ç¢ºå®šï¼šLINE/ãƒ¡ãƒ¼ãƒ«ã§ç›¸è«‡â†’åˆæ„å¾Œã«æœ¬å¥‘ç´„ã¸");
      lines.push("æ”¯æ‰•ã„ï¼šå½“æ—¥æ±ºæ¸ˆï¼ˆç¾é‡‘/æŒ¯è¾¼ï¼‰");
      return { id, text: lines.join("\n") };
    }

    lines.push(`äººæ•°ï¼š${p.people}å / ä½œæ¥­ï¼š${p.hours}æ™‚é–“`);
    lines.push(`ä½œæ¥­ã®ç¨®é¡ï¼š${p.typeLabel}`);
    lines.push(`ä½œæ¥­è²»ï¼š${yen(p.workFee)}`);
    lines.push(`åˆè¨ˆï¼š${yen(p.total)}ï¼ˆç¨è¾¼æ¦‚ç®—ï¼‰`);
    lines.push("â€”");
    lines.push("ç¢ºå®šï¼šLINE/ãƒ¡ãƒ¼ãƒ«ã§ç›¸è«‡â†’åˆæ„å¾Œã«æœ¬å¥‘ç´„ã¸");
    lines.push("æ”¯æ‰•ã„ï¼šå½“æ—¥æ±ºæ¸ˆï¼ˆç¾é‡‘/æŒ¯è¾¼ï¼‰");
    return { id, text: lines.join("\n") };
  }

  function buildDrivingCopy(p){
    const id = makeReservationId("drive");
    const lines = [];
    lines.push("ã€è¦‹ç©ï½œé‹ã¶ãƒ»ç§»å‹•ï½œè»½è²¨ç‰©TAKEã€‘");
    lines.push(`äºˆç´„IDï¼š${id}`);
    lines.push(`ã‚µãƒ¼ãƒ“ã‚¹ï¼š${p.serviceLabel}`);
    lines.push(`è»Šä¸¡å°æ•°ï¼š${p.vans}å°ï¼ˆèµ°è¡Œåˆ†Ã—${p.vans}ï¼‰`);
    if(p.origin || p.destination){
      lines.push(`ç©åœ°ï¼š${p.origin || "(æœªå…¥åŠ›)"} / å¸åœ°ï¼š${p.destination || "(æœªå…¥åŠ›)"}`);
    }
    lines.push(`è·é›¢ï¼š${p.km}km`);
    lines.push(`å‡ºå¼µè²»ï¼š${yen(p.travelFeeBase)}ï¼ˆ${p.travelNote}ï¼‰`);
    if(p.datetime) lines.push(`å¸Œæœ›æ—¥æ™‚ï¼š${p.datetime}`);
    if(p.note) lines.push(`è£œè¶³ï¼š${p.note}`);
    lines.push("â€”");
    lines.push(`èµ°è¡Œåˆ†ï¼ˆåŸºæœ¬ï¼‹å‡ºå¼µï¼‰Ã—å°æ•°ï¼š${yen(p.drivePart)}ï¼ˆåŸºæœ¬${yen(p.baseFee)} + å‡ºå¼µ${yen(p.travelFeeBase)}ï¼‰Ã—${p.vans}`);
    if(p.stairsFee > 0) lines.push(`éšæ®µä»˜å¸¯ï¼š${yen(p.stairsFee)}`);
    if(p.laborFee > 0) lines.push(`è¿½åŠ äººä»¶è²»ï¼š${yen(p.laborFee)}ï¼ˆ${p.workers}äºº Ã— ${p.wHours}h Ã— ${yen(PRICE.extraLaborPerHour)}ï¼‰`);
    lines.push(`åˆè¨ˆï¼š${yen(p.total)}ï¼ˆç¨è¾¼æ¦‚ç®—ï¼‰`);
    lines.push("â€”");
    if(p.serviceKey === "shopping"){
      lines.push("â€»å•†å“ä»£ã¯å®Ÿè²»ã§ã™ï¼ˆã“ã“ã§ã¯å«ã‚ã¾ã›ã‚“ï¼‰ã€‚");
    }
    if(p.serviceKey === "carSupport"){
      lines.push("â€»è»Šæ¤œãƒ»æ•´å‚™ã¯æ³•å®šè²»ç”¨ãƒ»æ•´å‚™è²»ãŒåˆ¥é€”ã§ã€æœ€çµ‚è¦‹ç©ã«ãªã‚Šã¾ã™ã€‚");
    }
    lines.push("ç¢ºå®šï¼šLINE/ãƒ¡ãƒ¼ãƒ«ã§ç›¸è«‡â†’åˆæ„å¾Œã«æœ¬å¥‘ç´„ã¸");
    lines.push("æ”¯æ‰•ã„ï¼šå½“æ—¥æ±ºæ¸ˆï¼ˆç¾é‡‘/æŒ¯è¾¼ï¼‰");
    return { id, text: lines.join("\n") };
  }

  // =========================
  // æœ¬å¥‘ç´„ã¸ï¼ˆåˆ¥ãƒšãƒ¼ã‚¸ï¼‰â€” localStorage ã«ä¸‹æ›¸ãä¿å­˜ã—ã¦ç§»å‹•
  // =========================
  const BOOKING_DRAFT_KEY = "TAKESAN_BOOKING_DRAFT";
  function saveDraftAndGoBooking(draft){
    const estimate = { ...(draft.estimate || {}), email: CFG.EMAIL_TO, lineUrl: CFG.LINE_URL };
    const safe = { ...draft, estimate, createdAt: new Date().toISOString(), lineUrl: CFG.LINE_URL, emailTo: CFG.EMAIL_TO };
    localStorage.setItem(BOOKING_DRAFT_KEY, JSON.stringify(safe));
    const url = `${CFG.BOOKING_PAGE_URL}?type=${encodeURIComponent(draft.type)}`;
    window.location.href = url;
  }

  // =========================
  // è¨ˆç®—ï¼šæ‰‹ä¼ã†ãƒ»ä½œæ¥­
  // =========================
  document.getElementById("btnCalcHelping").addEventListener("click", ()=>{
    const serviceKey = document.getElementById("h_service").value;
    const km = num(document.getElementById("h_km").value, 0);
    const note = document.getElementById("h_note").value.trim();
    const dt = H_DT.getValue();

    const travel = calcTravelFee(km);

    const labelMap = {
      grass: "è‰åˆˆã‚Šï¼ˆè¢‹è©°ã‚è¾¼ï½œé¢ç©ï¼‰",
      kerosene: "ç¯æ²¹è²·ã„å‡ºã—ï¼†çµ¦æ²¹ï¼ˆãƒãƒªç¼¶æ•°ï¼‰",
      estate: "ä¸ç”¨å“ä»•åˆ†ã‘ãƒ»ç‰‡ä»˜ã‘ç›¸è«‡ï¼ˆè²·å–ãªã—ï¼‰",
      light: "è»½ä½œæ¥­ï¼ˆæƒé™¤/é›»çƒäº¤æ›/ã‚´ãƒŸå‡ºã—æº–å‚™ï¼‰",
      hard: "åŠ›ä»•äº‹ï¼ˆå®¶å…·ç§»å‹•/é‡é‡ç‰©ï¼‰",
      web: "ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸åˆ¶ä½œï¼ˆè²·ã„åˆ‡ã‚Šï¼‰"
    };

    if(serviceKey === "grass"){
      const areaM2 = Math.max(0, num(document.getElementById("g_area").value, 0));
      const grassFee = Math.max(PRICE.grassMinFee, areaM2 * PRICE.grassRatePerM2);
      const total = travel.fee + grassFee;

      const breakdown = [
        { k:"ã‚µãƒ¼ãƒ“ã‚¹", v: labelMap[serviceKey] },
        { k:"è·é›¢", v: `${km || 0}km` },
        { k:"å‡ºå¼µè²»", v: yen(travel.fee) },
        { k:"åºƒã•", v: `${areaM2}ã¡` },
        { k:"è‰åˆˆã‚Š", v: `${yen(grassFee)}ï¼ˆ${PRICE.grassRatePerM2}å††/ã¡ï½œæœ€ä½${yen(PRICE.grassMinFee)}ï¼‰` },
        { k:"åˆè¨ˆ", v: yen(total) }
      ];

      document.getElementById("resultHelping").style.display = "block";
      document.getElementById("h_total").innerText = yen(total);
      renderBreakdown(document.getElementById("h_breakdown"), breakdown);

      const payload = {
        type:"helping",
        serviceKey,
        serviceLabel: labelMap[serviceKey],
        km: km || 0,
        travelFee: travel.fee,
        travelNote: travel.note,
        datetime: dt,
        note,
        areaM2,
        grassFee,
        total,
        breakdown
      };

      const pack = buildHelpingCopy(payload);
      lastHelping = { payload, copyText: pack.text };
      setMessageBody(pack.text);

      bounceShow(document.getElementById("h_booking"));
      showToast("è¨ˆç®—OK", "è¦‹ç©ãŒLINE/ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã«å…¥ã‚Šã¾ã—ãŸ");
      return;
    }

    if(serviceKey === "kerosene"){
      const cans = Math.max(1, int(document.getElementById("k_cans").value, 1));
      const extra = Math.max(0, cans - 1);
      const keroseneFee = PRICE.keroseneBaseFee + extra * PRICE.kerosenePerExtraCan;
      const total = travel.fee + keroseneFee;

      const breakdown = [
        { k:"ã‚µãƒ¼ãƒ“ã‚¹", v: labelMap[serviceKey] },
        { k:"è·é›¢", v: `${km || 0}km` },
        { k:"å‡ºå¼µè²»", v: yen(travel.fee) },
        { k:"18Lãƒãƒªç¼¶", v: `${cans}å€‹` },
        { k:"ç¯æ²¹ä½œæ¥­", v: `${yen(keroseneFee)}ï¼ˆåŸºæœ¬${yen(PRICE.keroseneBaseFee)} + è¿½åŠ Ã—${yen(PRICE.kerosenePerExtraCan)}ï¼‰` },
        { k:"åˆè¨ˆ", v: yen(total) }
      ];

      document.getElementById("resultHelping").style.display = "block";
      document.getElementById("h_total").innerText = yen(total);
      renderBreakdown(document.getElementById("h_breakdown"), breakdown);

      const payload = {
        type:"helping",
        serviceKey,
        serviceLabel: labelMap[serviceKey],
        km: km || 0,
        travelFee: travel.fee,
        travelNote: travel.note,
        datetime: dt,
        note,
        cans,
        keroseneFee,
        total,
        breakdown
      };

      const pack = buildHelpingCopy(payload);
      lastHelping = { payload, copyText: pack.text };
      setMessageBody(pack.text);

      bounceShow(document.getElementById("h_booking"));
      showToast("è¨ˆç®—OK", "è¦‹ç©ãŒLINE/ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã«å…¥ã‚Šã¾ã—ãŸ");
      return;
    }

    if(serviceKey === "estate"){
      const vans = Math.max(1, int(document.getElementById("e_vans").value, 1));
      const heavy = int(document.getElementById("e_heavy").value, 0);
      const hours = roundToHalfHourHours(num(document.getElementById("e_hours").value, 2));
      syncEstateDefaults();
      const staff = int(document.getElementById("e_staff").value, 1);

      const baseStaff = (vans === 1) ? PRICE.estateBaseStaffFor1Van : PRICE.estateBaseStaffFor2Van;
      const maxStaff = (vans === 1) ? PRICE.estateMaxStaffFor1Van : PRICE.estateMaxStaffFor2Van;

      const staffClamped = Math.max(baseStaff, Math.min(maxStaff, staff));
      document.getElementById("e_staff").value = String(staffClamped);

      const vanFee = vans * PRICE.vanFeePerUnit;

      const extraStaff = Math.max(0, staffClamped - baseStaff);
      const baseWork = hours * PRICE.lightPerHour * baseStaff;
      const extraRate = (heavy ? PRICE.hardPerHour : PRICE.lightPerHour);
      const extraWork = hours * extraRate * extraStaff;
      const workFee = baseWork + extraWork;

      const total = travel.fee + vanFee + workFee;

      const breakdown = [
        { k:"ã‚µãƒ¼ãƒ“ã‚¹", v: labelMap[serviceKey] },
        { k:"è·é›¢", v: `${km || 0}km` },
        { k:"å‡ºå¼µè²»", v: yen(travel.fee) },
        { k:"è»Šä¸¡", v: `${vans}å°ï¼ˆ${yen(vanFee)}ï¼‰` },
        { k:"ã‚¹ã‚¿ãƒƒãƒ•", v: `${staffClamped}åï¼ˆåŸºæœ¬${baseStaff}å + è¿½åŠ ${extraStaff}åï¼‰` },
        { k:"ä½œæ¥­æ™‚é–“", v: `${hours}æ™‚é–“` },
        { k:"ä½œæ¥­è²»", v: `${yen(workFee)}ï¼ˆåŸºæœ¬ï¼š${yen(baseWork)} / è¿½åŠ ï¼š${yen(extraWork)}ï¼‰` },
        { k:"åˆè¨ˆ", v: yen(total) }
      ];

      document.getElementById("resultHelping").style.display = "block";
      document.getElementById("h_total").innerText = yen(total);
      renderBreakdown(document.getElementById("h_breakdown"), breakdown);

      const payload = {
        type:"helping",
        serviceKey,
        serviceLabel: labelMap[serviceKey],
        km: km || 0,
        travelFee: travel.fee,
        travelNote: travel.note,
        datetime: dt,
        note,
        vans,
        vanFee,
        heavy: !!heavy,
        staff: staffClamped,
        baseStaff,
        extraStaff,
        hours,
        workFee,
        total,
        breakdown
      };

      const pack = buildHelpingCopy(payload);
      lastHelping = { payload, copyText: pack.text };
      setMessageBody(pack.text);

      bounceShow(document.getElementById("h_booking"));
      showToast("è¨ˆç®—OK", "è¦‹ç©ãŒLINE/ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã«å…¥ã‚Šã¾ã—ãŸ");
      return;
    }

    if(serviceKey === "web"){
      const total = travel.fee + PRICE.webBaseMin;

      const breakdown = [
        { k:"ã‚µãƒ¼ãƒ“ã‚¹", v: labelMap[serviceKey] },
        { k:"è·é›¢", v: `${km || 0}km` },
        { k:"å‡ºå¼µè²»", v: yen(travel.fee) },
        { k:"åˆ¶ä½œè²»ï¼ˆæœ€ä½ï¼‰", v: yen(PRICE.webBaseMin) },
        { k:"åˆè¨ˆ", v: yen(total) }
      ];

      document.getElementById("resultHelping").style.display = "block";
      document.getElementById("h_total").innerText = yen(total);
      renderBreakdown(document.getElementById("h_breakdown"), breakdown);

      const payload = {
        type:"helping",
        serviceKey,
        serviceLabel: labelMap[serviceKey],
        km: km || 0,
        travelFee: travel.fee,
        travelNote: travel.note,
        datetime: dt,
        note,
        total,
        breakdown
      };

      const pack = buildHelpingCopy(payload);
      lastHelping = { payload, copyText: pack.text };
      setMessageBody(pack.text);

      bounceShow(document.getElementById("h_booking"));
      showToast("è¨ˆç®—OK", "è¦‹ç©ãŒLINE/ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã«å…¥ã‚Šã¾ã—ãŸ");
      return;
    }

    // hourly
    const people = int(document.getElementById("h_people").value, 1);
    const hours = roundToHalfHourHours(num(document.getElementById("h_hours").value, 1));
    if(hours <= 0){
      showToast("å…¥åŠ›ä¸è¶³", "ä½œæ¥­æ™‚é–“ã‚’å…¥ã‚Œã¦ãã ã•ã„ï¼ˆ0.5æ™‚é–“ä»¥ä¸Šï¼‰");
      return;
    }
    const typeForCalc = (serviceKey === "hard") ? "hard" : (serviceKey === "light" ? "light" : helpingType);
    const work = calcHourlyFee(hours, typeForCalc, people);
    const typeLabel = (typeForCalc === "hard") ? "åŠ›ä»•äº‹ï¼ˆ3,300å††/æ™‚ï¼‰" : "è»½ä½œæ¥­ï¼ˆ2,200å††/æ™‚ï¼‰";
    const total = travel.fee + work.fee;

    const breakdown = [
      { k:"ã‚µãƒ¼ãƒ“ã‚¹", v: labelMap[serviceKey] || serviceKey },
      { k:"è·é›¢", v: `${km || 0}km` },
      { k:"å‡ºå¼µè²»", v: yen(travel.fee) },
      { k:"äººæ•°", v: `${work.people}å` },
      { k:"ä½œæ¥­æ™‚é–“", v: `${work.hours}æ™‚é–“` },
      { k:"ä½œæ¥­ã®ç¨®é¡", v: typeLabel },
      { k:"ä½œæ¥­è²»", v: yen(work.fee) },
      { k:"åˆè¨ˆ", v: yen(total) }
    ];

    document.getElementById("resultHelping").style.display = "block";
    document.getElementById("h_total").innerText = yen(total);
    renderBreakdown(document.getElementById("h_breakdown"), breakdown);

    const payload = {
      type:"helping",
      serviceKey,
      serviceLabel: labelMap[serviceKey] || serviceKey,
      km: km || 0,
      travelFee: travel.fee,
      travelNote: travel.note,
      datetime: dt,
      note,
      people: work.people,
      hours: work.hours,
      typeLabel,
      workFee: work.fee,
      total,
      breakdown
    };

    const pack = buildHelpingCopy(payload);
    lastHelping = { payload, copyText: pack.text };
    setMessageBody(pack.text);

    bounceShow(document.getElementById("h_booking"));
    showToast("è¨ˆç®—OK", "è¦‹ç©ãŒLINE/ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã«å…¥ã‚Šã¾ã—ãŸ");
  });

  document.getElementById("h_copy").addEventListener("click", async ()=>{
    if(!lastHelping){ showToast("å…ˆã«è¨ˆç®—ã—ã¦ãã ã•ã„", "è¨ˆç®—â†’ã‚³ãƒ”ãƒ¼ã®é †ã§ã™"); return; }
    const ok = await copyToClipboard(lastHelping.copyText);
    showToast(ok ? "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ" : "ã‚³ãƒ”ãƒ¼å¤±æ•—", "LINE/ãƒ¡ãƒ¼ãƒ«ã«è²¼ã‚Šä»˜ã‘ã§ãã¾ã™");
  });

  document.getElementById("h_toContact").addEventListener("click", async ()=>{
    if(!lastHelping){ showToast("å…ˆã«è¨ˆç®—ã—ã¦ãã ã•ã„", "è¨ˆç®—â†’é€£çµ¡ã®é †ã§ã™"); return; }
    await copyToClipboard(lastHelping.copyText);
    moveToContactAndFill(lastHelping.copyText);
    showToast("é€£çµ¡ã¸", "æœ¬æ–‡ã¯ã‚³ãƒ”ãƒ¼æ¸ˆã¿ï¼†ãƒ¡ãƒ¼ãƒ«æ¬„ã«ã‚‚å…¥ã‚Œã¾ã—ãŸã€‚LINE/ãƒ¡ãƒ¼ãƒ«ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚");
  });

  document.getElementById("h_booking").addEventListener("click", ()=>{
    if(!lastHelping){ showToast("å…ˆã«è¨ˆç®—ã—ã¦ãã ã•ã„", "è¨ˆç®—â†’æœ¬å¥‘ç´„ã®é †ã§ã™"); return; }
    saveDraftAndGoBooking({
      type: "helping",
      quoteText: lastHelping.copyText,
      estimate: lastHelping.payload
    });
  });

  // =========================
  // è¨ˆç®—ï¼šé‹ã¶ãƒ»ç§»å‹•ï¼ˆè»Šä¸¡å°æ•°Ã—èµ°è¡Œåˆ† + è¿½åŠ äººä»¶è²»ï¼‰
  // =========================
  document.getElementById("btnCalcDriving").addEventListener("click", ()=>{
    const serviceKey = document.getElementById("d_service").value;
    const km = num(document.getElementById("d_km").value, 0);
    const vans = Math.max(1, Math.min(2, int(document.getElementById("d_vans").value, 1)));
    const note = document.getElementById("d_note").value.trim();
    const dt = D_DT.getValue();

    const travel = calcTravelFee(km);

    const labelMap = {
      haul: "é‹æ¬ï¼ˆè·é›¢ï¼†éšæ®µï¼‰",
      shopping: "è²·ã„ç‰©ä»£è¡Œï¼ˆ2,200å††ã€œï¼‰",
      carSupport: "è»Šæ¤œãƒ»æ•´å‚™ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼è»Šæ¤œä»£è¡Œï¼æ¬å…¥ï¼‰"
    };

    let baseFee = PRICE.haulBaseFee;
    if(serviceKey === "shopping") baseFee = PRICE.shoppingBaseFee;
    if(serviceKey === "carSupport") baseFee = PRICE.carSupportBaseFee;

    // â˜…èµ°è¡Œåˆ†ï¼ˆåŸºæœ¬ï¼‹å‡ºå¼µï¼‰ã‚’è»Šä¸¡å°æ•°ã§å€åŒ–
    const travelFeeBase = travel.fee;
    const drivePart = (baseFee + travelFeeBase) * vans;

    // ä»˜å¸¯ï¼šé‹æ¬ã®ã¿éšæ®µè¨ˆç®—
    let stairsFee = 0;
    let origin = "";
    let destination = "";
    if(serviceKey === "haul"){
      origin = document.getElementById("d_origin").value.trim();
      destination = document.getElementById("d_destination").value.trim();

      const pickFloor = int(document.getElementById("d_pickFloor").value, 1);
      const dropFloor = int(document.getElementById("d_dropFloor").value, 1);
      const pickElev = document.getElementById("d_pickElev").value === "yes";
      const dropElev = document.getElementById("d_dropElev").value === "yes";

      const feePick = calcStairsFee(pickFloor, pickElev);
      const feeDrop = calcStairsFee(dropFloor, dropElev);
      stairsFee = feePick + feeDrop;
    }

    // è¿½åŠ äººä»¶è²»ï¼ˆãƒ‰ãƒ©ã‚¤ãƒãƒ¼ä»¥å¤–ï¼‰ 2,200å††/äººãƒ»æ™‚
    const workers = Math.max(0, int(document.getElementById("d_workers").value, 0));
    const wHours = roundToHalfHourHours(num(document.getElementById("d_wHours").value, 0));
    const laborFee = workers * wHours * PRICE.extraLaborPerHour;

    const total = drivePart + stairsFee + laborFee;

    const breakdown = [
      { k:"ã‚µãƒ¼ãƒ“ã‚¹", v: labelMap[serviceKey] || serviceKey },
      { k:"è»Šä¸¡å°æ•°", v: `${vans}å°ï¼ˆèµ°è¡Œåˆ†Ã—${vans}ï¼‰` },
      { k:"è·é›¢", v: `${km || 0}km` },
      { k:"èµ°è¡Œåˆ†ï¼ˆåŸºæœ¬ï¼‹å‡ºå¼µï¼‰Ã—å°æ•°", v: `${yen(drivePart)}ï¼ˆåŸºæœ¬${yen(baseFee)} + å‡ºå¼µ${yen(travelFeeBase)}ï¼‰Ã—${vans}` },
    ];
    if(serviceKey === "haul"){
      breakdown.push({ k:"éšæ®µä»˜å¸¯", v: stairsFee ? yen(stairsFee) : "ãªã—ï¼ˆã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼/1éšï¼‰" });
    }
    breakdown.push({ k:"è¿½åŠ äººä»¶è²»ï¼ˆãƒ‰ãƒ©ã‚¤ãƒãƒ¼ä»¥å¤–ï¼‰", v: laborFee ? `${yen(laborFee)}ï¼ˆ${workers}äºº Ã— ${wHours}h Ã— ${yen(PRICE.extraLaborPerHour)}ï¼‰` : "ãªã—" });
    breakdown.push({ k:"åˆè¨ˆ", v: yen(total) });

    document.getElementById("resultDriving").style.display = "block";
    document.getElementById("d_total").innerText = yen(total);
    renderBreakdown(document.getElementById("d_breakdown"), breakdown);

    const payload = {
      type:"driving",
      serviceKey,
      serviceLabel: labelMap[serviceKey] || serviceKey,
      vans,
      origin, destination,
      km: km || 0,
      travelFeeBase,
      travelNote: travel.note,
      datetime: dt,
      note,
      baseFee,
      drivePart,
      stairsFee,
      workers,
      wHours,
      laborFee,
      total,
      breakdown
    };

    const pack = buildDrivingCopy(payload);
    lastDriving = { payload, copyText: pack.text };
    setMessageBody(pack.text);

    bounceShow(document.getElementById("d_booking"));
    showToast("è¨ˆç®—OK", "è¦‹ç©ãŒLINE/ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã«å…¥ã‚Šã¾ã—ãŸ");
  });

  document.getElementById("d_copy").addEventListener("click", async ()=>{
    if(!lastDriving){ showToast("å…ˆã«è¨ˆç®—ã—ã¦ãã ã•ã„", "è¨ˆç®—â†’ã‚³ãƒ”ãƒ¼ã®é †ã§ã™"); return; }
    const ok = await copyToClipboard(lastDriving.copyText);
    showToast(ok ? "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ" : "ã‚³ãƒ”ãƒ¼å¤±æ•—", "LINE/ãƒ¡ãƒ¼ãƒ«ã«è²¼ã‚Šä»˜ã‘ã§ãã¾ã™");
  });

  document.getElementById("d_toContact").addEventListener("click", async ()=>{
    if(!lastDriving){ showToast("å…ˆã«è¨ˆç®—ã—ã¦ãã ã•ã„", "è¨ˆç®—â†’é€£çµ¡ã®é †ã§ã™"); return; }
    await copyToClipboard(lastDriving.copyText);
    moveToContactAndFill(lastDriving.copyText);
    showToast("é€£çµ¡ã¸", "æœ¬æ–‡ã¯ã‚³ãƒ”ãƒ¼æ¸ˆã¿ï¼†ãƒ¡ãƒ¼ãƒ«æ¬„ã«ã‚‚å…¥ã‚Œã¾ã—ãŸã€‚LINE/ãƒ¡ãƒ¼ãƒ«ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚");
  });

  document.getElementById("d_booking").addEventListener("click", ()=>{
    if(!lastDriving){ showToast("å…ˆã«è¨ˆç®—ã—ã¦ãã ã•ã„", "è¨ˆç®—â†’æœ¬å¥‘ç´„ã®é †ã§ã™"); return; }
    saveDraftAndGoBooking({
      type: "driving",
      quoteText: lastDriving.copyText,
      estimate: lastDriving.payload
    });
  });

  // =========================
  // ãƒ•ãƒƒã‚¿ãƒ¼ï¼šãƒ¡ãƒ¼ãƒ« / ç›´è¿‘ã‚³ãƒ”ãƒ¼ / LINEã¸æµã—è¾¼ã¿
  // =========================
  document.getElementById("btnMailJump").addEventListener("click", ()=>{
    document.getElementById("mailForm").scrollIntoView({ behavior:"smooth", block:"start" });
  });

  document.getElementById("btnCopyLast").addEventListener("click", async ()=>{
    if(!lastQuoteText){
      showToast("ã¾ã è¦‹ç©ãŒã‚ã‚Šã¾ã›ã‚“", "å³ã®è¨ˆç®—æ©Ÿã§è¨ˆç®—ã—ã¦ãã ã•ã„");
      return;
    }
    const ok = await copyToClipboard(lastQuoteText);
    showToast(ok ? "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ" : "ã‚³ãƒ”ãƒ¼å¤±æ•—", "LINE/ãƒ¡ãƒ¼ãƒ«ã«è²¼ã‚Šä»˜ã‘ã§ãã¾ã™");
  });

  // LINEï¼šè¦‹ç©ãŒã‚ã‚Œã°æœ¬æ–‡ã‚’é–‹ãï¼ˆãªã‘ã‚Œã°å‹ã ã¡è¿½åŠ ãƒªãƒ³ã‚¯ï¼‰
  document.getElementById("btnLineOpen").addEventListener("click", async (e)=>{
    e.preventDefault();
    if(!lastQuoteText){
      window.open(CFG.LINE_URL, "_blank", "noopener,noreferrer");
      showToast("LINE", "å‹ã ã¡è¿½åŠ ãƒªãƒ³ã‚¯ã‚’é–‹ãã¾ã—ãŸ");
      return;
    }
    // ã¾ãšã‚³ãƒ”ãƒ¼ï¼ˆå¤±æ•—ã—ã¦ã‚‚ç¶šè¡Œï¼‰
    await copyToClipboard(lastQuoteText);

    // LINEã®â€œæœ¬æ–‡ä»˜ãâ€èµ·å‹•ï¼ˆshareï¼‰
    const shareUrl = "https://line.me/R/msg/text/?" + encodeURIComponent(lastQuoteText.slice(0, 5000));
    window.open(shareUrl, "_blank", "noopener,noreferrer");
    showToast("LINEã‚’é–‹ãã¾ã—ãŸ", "æœ¬æ–‡ã¯ã‚³ãƒ”ãƒ¼æ¸ˆã¿ã§ã™ï¼ˆè²¼ã‚Šä»˜ã‘ã‚‚ã§ãã¾ã™ï¼‰");
  });

  document.getElementById("btnMailCopy").addEventListener("click", async ()=>{
    const body = document.getElementById("m_body").value.trim();
    if(!body){ showToast("æœ¬æ–‡ãªã—", "ç›¸è«‡å†…å®¹ã‚’å…¥ã‚Œã¦ãã ã•ã„"); return; }
    const ok = await copyToClipboard(body);
    showToast(ok ? "ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ" : "ã‚³ãƒ”ãƒ¼å¤±æ•—", "ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã«è²¼ã‚Šä»˜ã‘ã§ãã¾ã™");
  });

  document.getElementById("btnMailSend").addEventListener("click", async ()=>{
    const name = document.getElementById("m_name").value.trim();
    const reply = document.getElementById("m_reply").value.trim();
    const bodyRaw = document.getElementById("m_body").value.trim();
    if(!bodyRaw){ showToast("æœ¬æ–‡ãªã—", "ç›¸è«‡å†…å®¹ã‚’å…¥ã‚Œã¦ãã ã•ã„"); return; }

    const lines = [];
    lines.push("ã€è»½è²¨ç‰©TAKE ç›¸è«‡ã€‘");
    if(name) lines.push(`ãŠåå‰ï¼š${name}`);
    if(reply) lines.push(`è¿”ä¿¡ç”¨ãƒ¡ãƒ¼ãƒ«ï¼š${reply}`);
    lines.push("â€”");
    lines.push(bodyRaw);

    const body = lines.join("\n");
    await copyToClipboard(body);

    const url = buildMailto("è»½è²¨ç‰©TAKEï½œç›¸è«‡", body);
    window.open(url, "_blank");
    showToast("ãƒ¡ãƒ¼ãƒ«ã‚’ä½œæˆ", "æœ¬æ–‡ã¯ã‚³ãƒ”ãƒ¼æ¸ˆã¿ã§ã™ï¼ˆå¿…è¦ãªã‚‰è²¼ã‚Šä»˜ã‘ã¦é€ä¿¡ï¼‰");
  });

  // =========================
  // ãƒŠãƒ“ï¼šç¢ºå®Ÿã«å‹•ãã‚¹ãƒ ãƒ¼ã‚¹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼ˆå›ºå®šãƒ˜ãƒƒãƒ€ãƒ¼åˆ†ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆï¼‰
  // =========================
  function smoothScrollToTarget(target){
    const header = document.querySelector("header");
    const offset = (header?.offsetHeight || 0) + 10;
    const rect = target.getBoundingClientRect();
    const top = window.pageYOffset + rect.top - offset;
    window.scrollTo({ top, behavior:"smooth" });
  }

  document.querySelectorAll('a[href^="#"]').forEach(a=>{
    a.addEventListener("click", (e)=>{
      const href = a.getAttribute("href");
      if(!href || href === "#") return;
      const target = document.querySelector(href);
      if(!target) return;
      e.preventDefault();
      smoothScrollToTarget(target);
    });
  });

  // =========================
  // UIï¼šä¸Šã¸æˆ»ã‚‹
  // =========================
  const fabTop = document.getElementById("fabTop");
  window.addEventListener("scroll", ()=>{
    fabTop.style.display = (window.scrollY > 420) ? "block" : "none";
  }, {passive:true});

  // =========================
  // ãƒ˜ãƒ«ãƒ—ã€Œï¼Ÿã€ï¼šèª¬æ˜ã¯æ—¢å­˜æœ¬æ–‡ã‹ã‚‰ã®å¼•ç”¨ã®ã¿
  // =========================
  var helpTitles = { hero: "ã“ã®ãƒšãƒ¼ã‚¸ã«ã¤ã„ã¦", calc: "è¦‹ç©ï¼ˆè¨ˆç®—æ©Ÿï¼‰", services: "ã§ãã‚‹ã“ã¨", faq: "ã‚ˆãã‚ã‚‹è³ªå•", contact: "é€£çµ¡ï¼ˆLINE / ãƒ¡ãƒ¼ãƒ«ï¼‰" };
  var helpBodies = {
    hero: "å·¦ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’æŠ¼ã™ã¨ã€å³ã®è¨ˆç®—æ©ŸãŒè‡ªå‹•ã§åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚ã¾ãšã¯ã€Œã„ãã‚‰ã‹ï¼Ÿã€ã‚’å‡ºã—ã¦ã€ãƒšãƒ¼ã‚¸ä¸‹ã®LINEã‹ãƒ¡ãƒ¼ãƒ«ã§é€ã£ã¦ãã ã•ã„ã€‚æµã‚Œï¼šâ‘ è¦‹ç©ï¼ˆå³ï¼‰ â†’ â‘¡ä¸‹ã®LINE/ãƒ¡ãƒ¼ãƒ«ã§ç›¸è«‡ãƒ»åˆæ„ â†’ â‘¢æœ¬å¥‘ç´„ï¼ˆåˆ¥ãƒšãƒ¼ã‚¸ï¼‰ â†’ â‘£å½“æ—¥ä½œæ¥­ãƒ»å½“æ—¥æ±ºæ¸ˆ",
    calc: "20kmåœå†…ï¼šå‡ºå¼µç„¡æ–™ã€‚è¶…éã¯5kmã”ã¨ã«+550å††ï¼ˆç¨è¾¼ï¼‰ã€‚çµæœã«ã€Œã„ãã‚‰ã‹ï¼Ÿã€ã‚’è¡¨ç¤º â†’ LINE/ãƒ¡ãƒ¼ãƒ«ã¸è‡ªå‹•åæ˜ ã€‚æ¦‚ç®—ã§ã™ã€‚ç¾åœ°çŠ¶æ³ã§èª¿æ•´ãŒå…¥ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚å½“æ—¥æ±ºæ¸ˆï¼ˆç¾é‡‘/æŒ¯è¾¼ï¼‰ã€‚ç¢ºå®šã¯ä¸‹ã®LINE/ãƒ¡ãƒ¼ãƒ«ã§åˆæ„å¾Œã«æœ¬å¥‘ç´„ã¸ã€‚",
    services: "ã§ãã‚‹ã“ã¨ï¼ˆæŠ¼ã™ã¨å³ã«åæ˜ ï¼‰ã€‚è‰åˆˆã‚Šãƒ»ç¯æ²¹è²·ã„å‡ºã—ãƒ»ä¸ç”¨å“ä»•åˆ†ã‘ãƒ»ç‰‡ä»˜ã‘ç›¸è«‡ãƒ»é‹æ¬ãƒ»è²·ã„ç‰©ä»£è¡Œãƒ»è»Šæ¤œãƒ»æ•´å‚™ãƒ»ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸åˆ¶ä½œãªã©ã€‚å„é …ç›®ã‚’é–‹ãã¨èª¬æ˜ãŒã‚ã‚Šã¾ã™ã€‚",
    faq: "ã‚ˆãã‚ã‚‹è³ªå•ã¯ä¸‹ã®æŠ˜ã‚ŠãŸãŸã¿ã§ã”ç¢ºèªãã ã•ã„ã€‚æ”¯æ‰•ã„æ–¹æ³•ãƒ»å‡ºå¼µè²»ãƒ»è‰åˆˆã‚Šã®ã‚´ãƒŸãƒ»ç¯æ²¹ã®å•†å“ä»£ãƒ»ç‰‡ä»˜ã‘ã®ç¯„å›²ãƒ»é€£çµ¡æ‰‹æ®µãªã©ã€‚",
    contact: "é€£çµ¡ï¼ˆLINE / ãƒ¡ãƒ¼ãƒ«ï¼‰ã€‚è¨ˆç®—ã—ãŸè¦‹ç©ãŒè‡ªå‹•ã§æœ¬æ–‡ã«å…¥ã‚Šã¾ã™ã€‚é›»è©±ç•ªå·ã¯éæ²è¼‰ã§ã™ï¼ˆå±¥æ­´ãŒæ®‹ã‚‹LINE/ãƒ¡ãƒ¼ãƒ«ã‚’å„ªå…ˆï¼‰ã€‚å½“æ—¥æ±ºæ¸ˆï¼ˆç¾é‡‘/æŒ¯è¾¼ï¼‰ã€‚ç¢ºå®šã¯åˆæ„å¾Œã«æœ¬å¥‘ç´„ï¼ˆåˆ¥ãƒšãƒ¼ã‚¸ï¼‰ã¸ã€‚"
  };
  document.querySelectorAll(".helpBtn").forEach(function(btn){
    btn.addEventListener("click", function(){
      var id = this.getAttribute("data-help");
      var title = helpTitles[id] || "èª¬æ˜";
      var body = helpBodies[id] || "";
      document.getElementById("helpTitle").textContent = title;
      document.getElementById("helpContent").innerHTML = "<p>" + (body.replace(/</g,"&lt;").replace(/>/g,"&gt;")) + "</p>";
      var overlay = document.getElementById("helpOverlay");
      overlay.setAttribute("aria-hidden", "false");
      overlay.style.display = "flex";
    });
  });
  document.getElementById("helpClose").addEventListener("click", function(){
    document.getElementById("helpOverlay").setAttribute("aria-hidden", "true");
    document.getElementById("helpOverlay").style.display = "none";
  });
  document.getElementById("helpOverlay").addEventListener("click", function(e){
    if (e.target === this) {
      this.setAttribute("aria-hidden", "true");
      this.style.display = "none";
    }
  });
</script>
<script src="assets/sakura.js"></script>
</body>
</html>
